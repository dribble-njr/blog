import{_ as i,c as u,e as p,b as t,a as n,w as c,d as s,r as l,o as r}from"./app-nKKmHBUX.js";const k={},d={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API",target:"_blank",rel:"noopener noreferrer"},m={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DataTransfer",target:"_blank",rel:"noopener noreferrer"},v={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DataTransferItem",target:"_blank",rel:"noopener noreferrer"},b={href:"https://developer.mozilla.org/docs/Web/API/DataTransferItem/webkitGetAsEntry",target:"_blank",rel:"noopener noreferrer"},f={href:"https://developer.mozilla.org/en-US/docs/Web/API/FileSystemEntry",target:"_blank",rel:"noopener noreferrer"},y={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/FileSystemFileEntry",target:"_blank",rel:"noopener noreferrer"},g={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/FileSystemDirectoryEntry",target:"_blank",rel:"noopener noreferrer"},w={class:"hint-container warning"},h={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/File/webkitRelativePath",target:"_blank",rel:"noopener noreferrer"},E={href:"https://developer.mozilla.org/en-US/docs/Web/API/FileSystemEntry",target:"_blank",rel:"noopener noreferrer"};function D(x,a){const o=l("CodeDemo"),e=l("ExternalLinkIcon");return r(),u("div",null,[a[34]||(a[34]=p('<p>文件上传是前端开发中常见的需求，不管业务如何复杂，最关键的步骤在于如何获取文件数据，这里介绍几种常见的文件上传场景。</p><ul><li>选择上传</li><li>拖拽上传</li><li>粘贴上传</li></ul><h2 id="选择上传" tabindex="-1"><a class="header-anchor" href="#选择上传"><span>选择上传</span></a></h2><h3 id="单文件" tabindex="-1"><a class="header-anchor" href="#单文件"><span>单文件</span></a></h3><p>通过 <code>input</code> 标签的 <code>type</code> 属性设置为 <code>file</code>，然后监听 <code>change</code> 事件，获取文件数据。</p>',5)),t(o,{id:"code-demo-29",type:"normal",title:"%E5%8D%95%E6%96%87%E4%BB%B6",code:"eJx9Uk9rE0EU/yqPpZAthgleSxIQiSB4ELzuoePuJFnZzKy7s8EYFlqrFLQaBY1SpVjB1IvEWqitKfTL7G62J7+Cb3ayGil4GWbm9+f9Zt4bGl3Z84w1o+5yP5IgBz5rWEbb9ZhlQK1p8brj9pv1mlotblSNeyGybcFDCVrSAEfYUY9xSe5HLBjcYR6zpQjMSoFXVi2u6WjxHzKiilqSu5Q7HruBOa7jtsNQabJVaDRhaHEARkIp/NuB8GmHSldwE7UAS7lantIwImnQYVIZa1h4jHiiY5Ykot4aFpVLfXGD4mtBQAekHYjeZfa/ZssexZ60RdCidtcsoCpGctiDv/GXK93kbYHF1tVbYWVYMOEKXI3X8KQIhNMei8uD6lAM5srCR9cjofuQ6YsY7g4khlnXR/xWQn2fcadIoooV6QFqNUgnj7K9D9nWUT7ZTJ8cJ7NxNt5OZsfJ+X62Of11tpOOpsns88XGbn6+XRSCdHqaH+7Pdx+nh3vZxkH+4kc6GivDePF8tM2/bc1ff0EVrsnJ0+TsYzY+zY7eLODI9wTVcco/w9uLd9+zr5/m70/SlzuLFFr6FjfP84NJOnoFtp6F5OczxJXwT1/61ItUwysVi8fKtEAIdZxWH6ftlhtKxhnOmbaoVC9NGEYx4t+PnjuZ"},{default:c(()=>a[0]||(a[0]=[n("div",{class:"language-html line-numbers-mode","data-ext":"html","data-title":"html"},[n("pre",{class:"language-html"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("input")]),s(),n("span",{class:"token attr-name"},"type"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),s("file"),n("span",{class:"token punctuation"},'"')]),s(),n("span",{class:"token punctuation"},"/>")]),s(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("div")]),n("span",{class:"token punctuation"},">")]),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("div")]),n("span",{class:"token punctuation"},">")]),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" input "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"querySelector"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'input'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" div "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"querySelector"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'div'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleFileChange"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"stopPropagation"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" inputEle "),n("span",{class:"token operator"},"="),s(" e"),n("span",{class:"token punctuation"},"."),s(`target

  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("inputEle"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(" files "),n("span",{class:"token operator"},"="),s(" Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"from"),n("span",{class:"token punctuation"},"("),s("inputEle"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},")"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("files"),n("span",{class:"token punctuation"},")"),s(`

  files`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("file"),n("span",{class:"token punctuation"},","),s(" index")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" fileInfo "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"File "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("index "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},": "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("file"),n("span",{class:"token punctuation"},"."),s("type"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," ("),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s(`
      file`),n("span",{class:"token punctuation"},"."),s(`size
    `),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," bytes)"),n("span",{class:"token template-punctuation string"},"`")]),s(`
    div`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("fileInfo"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 如果想要其他文件信息，可以通过 file 对象的属性获取"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token comment"},"// 调用通用上传方法"),s(`
  `),n("span",{class:"token comment"},"// upload(files)"),s(`

  `),n("span",{class:"token comment"},"// 防止相同文件上传时不触发 change 事件"),s(`
  inputEle`),n("span",{class:"token punctuation"},"."),s("value "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"''"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

input`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"addEventListener"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'change'"),n("span",{class:"token punctuation"},","),s(" handleFileChange"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[0]}),a[35]||(a[35]=n("h3",{id:"多文件",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#多文件"},[n("span",null,"多文件")])],-1)),a[36]||(a[36]=n("p",null,[s("通过 "),n("code",null,"input"),s(" 标签的 "),n("code",null,"multiple"),s(" 属性设置为 "),n("code",null,"true"),s("，然后监听 "),n("code",null,"change"),s(" 事件，获取文件数据。")],-1)),t(o,{id:"code-demo-39",type:"normal",title:"%E5%A4%9A%E6%96%87%E4%BB%B6",code:"eJx9UlFr1EAQ/itDKCTFI4ev5e5A5ATBB8HXPHRN9u4iyW5MNofnEWitUtDqKegpVYoVvPoiZy3U1iv0zyS59Mm/4Gz2ooWWviw7O9/3zbczM9R6wve0Fa3hsiAWIAYBbVpax/WopYEfe8INPAr1lsUajttvNerytJhW0x5ESLM5iwQobhMcbsc+ZcJ8GNNwcI961BY8NPQyry9bTMFR4gowZiW0AvcIczx6Cw3dxGuXItOgy9BswdBiANSMBA/uhjwgXSJczgzkApzz1Ub/TcQJEnapkMIqzT1qerxrVCBTfjoqK1f88gXJN8KQDMxOyP3L0eXd7PCwTeyeYciwhsUd+ui/0fOat1mHo+yq/BUsDUskXIPryQpGEmAy4tOkCuRQEjCWFjqqnhm5j6l6SOD+QKCZVRViA00SBJQ5pRNZrOwJQL0O2eRJvvMp3zgoJuvZs8N0Ns7Hm+nsMD3dzdenf062stE0nX09W9suTjfLQpBNj4v93fn202x/J1/bK179ykZjKZgsvo+yxY+N+dtvyMIzPXqennzOx8f5wbtFOg48TpSdqmf4evbhZ/79y/zjUfZ6a+FCUd/j5WWxN8lGb8BWU09/v8C8JP6bQJ94sRytrlsskaJlxiSO0+7jXt1xI0EZxY1SEnrtwi6hFS35C51mN1Q="},{default:c(()=>a[1]||(a[1]=[n("div",{class:"language-html line-numbers-mode","data-ext":"html","data-title":"html"},[n("pre",{class:"language-html"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("input")]),s(),n("span",{class:"token attr-name"},"type"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),s("file"),n("span",{class:"token punctuation"},'"')]),s(),n("span",{class:"token attr-name"},"multiple"),s(),n("span",{class:"token punctuation"},"/>")]),s(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("div")]),n("span",{class:"token punctuation"},">")]),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("div")]),n("span",{class:"token punctuation"},">")]),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" input "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"querySelector"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'input'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" div "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"querySelector"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'div'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleFileChange"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"stopPropagation"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" inputEle "),n("span",{class:"token operator"},"="),s(" e"),n("span",{class:"token punctuation"},"."),s(`target

  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("inputEle"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(" files "),n("span",{class:"token operator"},"="),s(" Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"from"),n("span",{class:"token punctuation"},"("),s("inputEle"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},")"),s(`

  files`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("file"),n("span",{class:"token punctuation"},","),s(" index")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" fileInfo "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"File "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("index "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},": "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("file"),n("span",{class:"token punctuation"},"."),s("type"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," ("),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s(`
      file`),n("span",{class:"token punctuation"},"."),s(`size
    `),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," bytes)"),n("span",{class:"token template-punctuation string"},"`")]),s(`
    div`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("fileInfo"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 如果想要其他文件信息，可以通过 file 对象的属性获取"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token comment"},"// 调用通用上传方法"),s(`
  `),n("span",{class:"token comment"},"// upload(files)"),s(`

  `),n("span",{class:"token comment"},"// 防止相同文件上传时不触发 change 事件"),s(`
  inputEle`),n("span",{class:"token punctuation"},"."),s("value "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"''"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

input`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"addEventListener"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'change'"),n("span",{class:"token punctuation"},","),s(" handleFileChange"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[1]}),a[37]||(a[37]=n("h3",{id:"目录上传",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#目录上传"},[n("span",null,"目录上传")])],-1)),a[38]||(a[38]=n("p",null,[s("通过 "),n("code",null,"input"),s(" 标签的 "),n("code",null,"webkitdirectory"),s(" 属性设置为 "),n("code",null,"true"),s("，然后监听 "),n("code",null,"change"),s(" 事件，获取文件数据。")],-1)),t(o,{id:"code-demo-49",type:"normal",title:"%E7%9B%AE%E5%BD%95%E4%B8%8A%E4%BC%A0",code:"eJx9Ut1qE0EUfpXDUsgWwwRvSxIQiSB4IXi7F51mJ8nqZmbdnY2uYaG1SkGrUdAoVYoVTL2RWAu1NYW+zO5me+UreGZ/tNLSm2HOfD/nm5kz1Hqyb2tLWt3iji9BBg5rGFrHspmhwQO2cs+SpuWythRuALWmweumNWjWa2o1uFbV7nqobgvuScgtGmCKtt9nXJL7PnODO8zO5HolwyuLBs/paHEJGVFFLck9yk2b3cBc13HbZajU2SI0mjA0OAAjnhTObVc4tEulJbiOWoAzuVq20jAiqdtlUhnnsLAZsUVXL0lE3d3LOpf67ATF11yXBqTjiv7F7GxPOsJt0XZP11VZxeYme/gv6FnPm7wj0HZZ3QoWhhkTrsDVcAkrRSCc9llYFupvQtAXCp+8H/GsRyw/CGElkBhmOS/xAQl1HMbNLIlqVuT8/+IKzB4LoFaDePI42f6YrO+nk7X46UE0GyfjjWh2EJ3sJGvT38eb8Wgazb6crm6lJxtZAoinR+neznzrSby3nazupi9/xqOxMgyLfmibfl+fv/mKKlyjw2fR8adkfJTsvy1g37EFzXOWj4mnp+9/JN8+zz8cxq82ixS59B1uXqS7k3j0Gtr5OES/niOuhH+/ZkBtX/15pWLwUJlmCKGm2RrgwN2yPMk4w1HLLSrVc0OGUbTwD8anQqs="},{default:c(()=>a[2]||(a[2]=[n("div",{class:"language-html line-numbers-mode","data-ext":"html","data-title":"html"},[n("pre",{class:"language-html"},[n("code",null,[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("input")]),s(),n("span",{class:"token attr-name"},"type"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),s("file"),n("span",{class:"token punctuation"},'"')]),s(),n("span",{class:"token attr-name"},"webkitdirectory"),s(),n("span",{class:"token punctuation"},"/>")]),s(`
`),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("div")]),n("span",{class:"token punctuation"},">")]),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("div")]),n("span",{class:"token punctuation"},">")]),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" input "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"querySelector"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'input'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(" div "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"querySelector"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'div'"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleFileChange"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"stopPropagation"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" inputEle "),n("span",{class:"token operator"},"="),s(" e"),n("span",{class:"token punctuation"},"."),s(`target

  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("inputEle"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(" files "),n("span",{class:"token operator"},"="),s(" Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"from"),n("span",{class:"token punctuation"},"("),s("inputEle"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},")"),s(`

  files`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("file"),n("span",{class:"token punctuation"},","),s(" index")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" fileInfo "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"File "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("index "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"},": "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("file"),n("span",{class:"token punctuation"},"."),s("type"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," ("),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s(`
      file`),n("span",{class:"token punctuation"},"."),s(`size
    `),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token string"}," bytes)"),n("span",{class:"token template-punctuation string"},"`")]),s(`
    div`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("fileInfo"),n("span",{class:"token punctuation"},")"),s(`

    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("file"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token comment"},"// 如果想要其他文件信息，可以通过 file 对象的属性获取"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token comment"},"// 调用通用上传方法"),s(`
  `),n("span",{class:"token comment"},"// upload(files)"),s(`

  `),n("span",{class:"token comment"},"// 防止相同文件上传时不触发 change 事件"),s(`
  inputEle`),n("span",{class:"token punctuation"},"."),s("value "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"''"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

input`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"addEventListener"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'change'"),n("span",{class:"token punctuation"},","),s(" handleFileChange"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[2]}),a[39]||(a[39]=n("h2",{id:"拖拽上传",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#拖拽上传"},[n("span",null,"拖拽上传")])],-1)),a[40]||(a[40]=n("p",null,"选择上传获取文件数据比较简单，下面来看最复杂的文件拖拽上传。",-1)),n("p",null,[a[4]||(a[4]=s("使用 ")),n("a",d,[a[3]||(a[3]=s("HTML Drag and Drop API")),t(e)]),a[5]||(a[5]=s(" 实现拖拽上传，主要涉及到以下几个事件："))]),a[41]||(a[41]=p('<ul><li><code>dragenter</code>：拖拽元素进入目标元素时触发；</li><li><code>dragover</code>：拖拽元素在目标元素上移动时触发（每 100 毫秒触发一次）；</li><li><code>dragleave</code>：拖拽元素离开目标元素时触发；</li><li><code>drop</code>：拖拽元素在目标元素上释放时触发。</li></ul><h3 id="实现拖拽区域交互" tabindex="-1"><a class="header-anchor" href="#实现拖拽区域交互"><span>实现拖拽区域交互</span></a></h3><p>首先实现拖拽区域的交互，当拖拽元素进入目标元素时，目标元素的边框变色。</p><p>仅需要设置一个 <code>drag-enter</code> 类，当拖拽元素进入目标元素时，添加该类，离开时移除该类。</p>',4)),t(o,{id:"code-demo-93",type:"react",title:"%E6%8B%96%E6%8B%BD%E5%8C%BA%E5%9F%9F%E4%BA%A4%E4%BA%92",code:"eJy1U8Fu00AQ/ZVROMSV4tQUIhFDyqXcEEhwJEjd2GNnyWbX2h2HtFbOIJVzr71wReLEAcTfkHwHa2/sOFF7QfQSeWfevLdv3qbofDCdsBMpaQgKyA2+JUYIKxjBG2QRjeVY4jJTmiDGhOWCwDuC0SkUYwng5t7FmqUvJKHugUE6q0/vLUnN6CVMGDwq6eqxKZOxwAZtwR7uqAGwn2lcoKQzJ+zZ6bLelvBI5yUrwOp26teL+2J+iWyB/0Zd7+IObpX9J1qNlGsJnsM+i/nCfVlBwYx5xeY4Ks7L9HymkZ3bMddWsmEdFQc5HYDKBbcx5fkAUm2qjakKeyCV7foqa1qGLoSdLGCidIw6hOalwXPoSiWxCyHk0j5NLjGG1XbytCZoe95z3a1c24Wi9ufMzLqNZks15iYT7OJAdiJUNCt1txeoRQGOG93N1fXm6vfm+tOfXz/Wn79vvn1df/m5vrnZJnFsr1VhbVp2utPrRKb8H/abLFzwmTKcuJKhjVIw4gt8WpbnXPofeUzTEAZBkC2b4hR5OqUQHjXVenEn2RJiZqZ2SQ+iKGr1fM1inhtLtR0hXJLPBE+tbFRtqConSpJv+CVaspo9UkJZ8i1j9eqchd1iD42wiVEiJ2eEVBZCUH1qd3N3mCgiNa9PApOmc+lzm/YyhOFw6GwznfKSNyd1p+OHT4ZBktxm2qJcmUWzVCv7lOyu0wnzTgZBD3Y/QX9wtGf5cTDEirLMb/UXjfjC0A=="},{default:c(()=>a[6]||(a[6]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("dragEnter"),n("span",{class:"token punctuation"},","),s(" setDragEnter"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragEnter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragOver"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragLeave"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDrop"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),s(`div
      className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"drag-area"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},"}"),s(`
      onDragEnter`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragEnter"),n("span",{class:"token punctuation"},"}"),s(`
      onDragOver`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragOver"),n("span",{class:"token punctuation"},"}"),s(`
      onDragLeave`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragLeave"),n("span",{class:"token punctuation"},"}"),s(`
      onDrop`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDrop"),n("span",{class:"token punctuation"},"}"),s(`
      style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"border"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s(`div
        className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"'drag-enter-mask'"),n("span",{class:"token punctuation"},"}"),s(`
        style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"display"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'block'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      拖拽文件到此区域
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("div"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-css line-numbers-mode","data-ext":"css","data-title":"css"},[n("pre",{class:"language-css"},[n("code",null,[n("span",{class:"token selector"},".drag-area"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" relative"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-width"),n("span",{class:"token punctuation"},":"),s(" 500px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-height"),n("span",{class:"token punctuation"},":"),s(" 300px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #ccc"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 5px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"text-align"),n("span",{class:"token punctuation"},":"),s(" center"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"font-size"),n("span",{class:"token punctuation"},":"),s(" 20px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #ccc"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token selector"},".drag-enter-mask"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" absolute"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"top"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"right"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"bottom"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"left"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"z-index"),n("span",{class:"token punctuation"},":"),s(" 999"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"margin"),n("span",{class:"token punctuation"},":"),s(" auto"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #1890ff"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 2px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"background"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token function"},"rgba"),n("span",{class:"token punctuation"},"("),s("250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 0.5"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #409eff"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[6]}),a[42]||(a[42]=n("h3",{id:"datatransfer",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#datatransfer"},[n("span",null,"DataTransfer")])],-1)),a[43]||(a[43]=n("p",null,[n("code",null,"DataTransfer"),s(" 对象用于保存拖动并放下过程中的数据。当拖拽元素在目标元素上释放时，需要监听 "),n("code",null,"onDrop"),s(" 事件，获取 "),n("code",null,"event.dataTransfer.items"),s("。")],-1)),n("p",null,[n("a",m,[a[7]||(a[7]=n("code",null,"DataTransfer",-1)),t(e)]),a[8]||(a[8]=s(" 接口定义了一些方法和属性："))]),a[44]||(a[44]=p(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">DataTransfer</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * 获取当前选定的拖放操作类型或者设置的为一个新的类型。值必须为 none, copy, link 或 move。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/dropEffect)
   */</span>
  dropEffect<span class="token operator">:</span> <span class="token string">&#39;none&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;copy&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;link&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;move&#39;</span>
  <span class="token doc-comment comment">/**
   * 提供所有可用的操作类型。必须是 none, copy, copyLink, copyMove, link, linkMove, move, all or uninitialized 之一。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/effectAllowed)
   */</span>
  effectAllowed<span class="token operator">:</span>
    <span class="token operator">|</span> <span class="token string">&#39;none&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;copy&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;copyLink&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;copyMove&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;link&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;linkMove&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;move&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;all&#39;</span>
    <span class="token operator">|</span> <span class="token string">&#39;uninitialized&#39;</span>
  <span class="token doc-comment comment">/**
   * 包含数据传输中可用的所有本地文件的列表。如果拖动操作不涉及拖动文件，则此属性为空列表。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/files)
   */</span>
  <span class="token keyword">readonly</span> files<span class="token operator">:</span> FileList
  <span class="token doc-comment comment">/**
   * 提供一个包含所有拖动数据列表的 DataTransferItemList 对象。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/items)
   */</span>
  <span class="token keyword">readonly</span> items<span class="token operator">:</span> DataTransferItemList
  <span class="token doc-comment comment">/**
   * 一个提供 dragstart 事件中设置的格式的 strings 数组。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/types)
   */</span>
  <span class="token keyword">readonly</span> types<span class="token operator">:</span> ReadonlyArray<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span>
  <span class="token doc-comment comment">/**
   * 删除与给定类型关联的数据。类型参数是可选的。如果类型为空或未指定，则删除与所有类型关联的数据。如果指定类型的数据不存在，或者 data transfer 中不包含任何数据，则该方法不会产生任何效果。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/clearData)
   */</span>
  <span class="token function">clearData</span><span class="token punctuation">(</span>format<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
  <span class="token doc-comment comment">/**
   * 检索给定类型的数据，如果该类型的数据不存在或 data transfer 不包含数据，则返回空字符串。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/getData)
   */</span>
  <span class="token function">getData</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token doc-comment comment">/**
   * 设置给定类型的数据。如果该类型的数据不存在，则将其添加到末尾，以便类型列表中的最后一项将是新的格式。如果该类型的数据已经存在，则在相同位置替换现有数据。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/setData)
   */</span>
  <span class="token function">setData</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
  <span class="token doc-comment comment">/**
   * 用于设置自定义的拖动图像。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransfer/setDragImage)
   */</span>
  <span class="token function">setDragImage</span><span class="token punctuation">(</span>image<span class="token operator">:</span> Element<span class="token punctuation">,</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p><code>DataTransfer.files</code> 属性只能返回文件列表，因此当拖动文件夹时，只能查看一个文件夹信息。</p><p>因此如果拖拽文件夹，需要使用 <code>dataTransfer.items</code>，该属性包含一个 <code>DataTransferItem</code> 数组。</p></div><div class="language-diff line-numbers-mode" data-ext="diff" data-title="diff"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const handleDrop = (e) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">   e.preventDefault()
</span><span class="token prefix unchanged"> </span><span class="token line">   setDragEnter(false)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   getFileData(e.dataTransfer.items)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="获取文件路径" tabindex="-1"><a class="header-anchor" href="#获取文件路径"><span>获取文件路径</span></a></h3><p><code>DataTransferItemList</code> 数组中包含 <code>DataTransferItem</code> 元素，拖拽几个文件或文件夹则会包含多少个 <code>DataTransferItem</code> 对象。</p>`,5)),n("p",null,[n("a",v,[a[9]||(a[9]=n("code",null,"DataTransferItem",-1)),t(e)]),a[10]||(a[10]=s(" 接口定义了一些属性和方法："))]),a[45]||(a[45]=p(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">DataTransferItem</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * 拖拽项的种类，string 或是 file。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransferItem/kind)
   */</span>
  <span class="token keyword">readonly</span> kind<span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token doc-comment comment">/**
   * 拖拽项的类型，一般是一个 MIME 类型。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransferItem/type)
   */</span>
  <span class="token keyword">readonly</span> type<span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token doc-comment comment">/**
   * 返回一个关联拖拽项的 File 对象（当拖拽项不是一个文件时返回 null）。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransferItem/getAsFile)
   */</span>
  <span class="token function">getAsFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> File <span class="token operator">|</span> <span class="token keyword">null</span>
  <span class="token doc-comment comment">/**
   * 使用拖拽项的字符串作为参数执行指定回调函数。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransferItem/getAsString)
   */</span>
  <span class="token function">getAsString</span><span class="token punctuation">(</span>callback<span class="token operator">:</span> FunctionStringCallback <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
  <span class="token doc-comment comment">/**
   * 返回一个基于 FileSystemEntry (en-US) 的对象来表示文件系统中选中的项目。通常是返回一个FileSystemFileEntry 或是 FileSystemDirectoryEntry 对象。
   *
   * [MDN Reference](https://developer.mozilla.org/docs/Web/API/DataTransferItem/webkitGetAsEntry) */</span>
  <span class="token function">webkitGetAsEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> FileSystemEntry <span class="token operator">|</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1)),n("p",null,[a[15]||(a[15]=s("由于拖拽对象可能是文件也可能是文件夹，因此需要通过该对象上的 ")),n("a",b,[a[11]||(a[11]=n("code",null,"webkitGetAsEntry()",-1)),t(e)]),a[16]||(a[16]=s(" 方法，获取 ")),n("a",f,[a[12]||(a[12]=n("code",null,"FileSystemEnry",-1)),t(e)]),a[17]||(a[17]=s(" 对象，该对象可能是 ")),n("a",y,[a[13]||(a[13]=n("code",null,"FileSystemFileEntry",-1)),t(e)]),a[18]||(a[18]=s(" 和 ")),n("a",g,[a[14]||(a[14]=n("code",null,"FileSystemDirectoryEntry",-1)),t(e)]),a[19]||(a[19]=s("。"))]),a[46]||(a[46]=p(`<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getFileData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">items</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>items<span class="token punctuation">)</span> <span class="token keyword">return</span>

  <span class="token comment">// 文件或目录路径列表</span>
  <span class="token keyword">const</span> fileEntryList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> items<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> entry <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">webkitGetAsEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fileEntryList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 这里上次一个文件夹，三个文件</span>
  <span class="token comment">// [DirectoryEntry, FileEntry, FileEntry, FileEntry]</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fileEntryList<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="递归获取文件" tabindex="-1"><a class="header-anchor" href="#递归获取文件"><span>递归获取文件</span></a></h3><p>当获取到所有 <code>FileSystemEntry</code> 对象后，即可递归获取文件。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">tranverseFileTree</span><span class="token punctuation">(</span>fileEntryList<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在 <code>traverseFileTree</code> 函数中，需要解析 <code>Entry</code> 获取文件对象：</p><ul><li>当对象是一个文件时，使用 <code>file()</code> 函数获取 <code>File</code> 对象；</li><li>当对象是一个文件夹时，使用 <code>createReader()</code> 函数创建一个阅读器，可以读取目录中的所有文件。</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p>这两个函数都是异步执行，因此需要使用 <code>promise</code>，保证能获取到文件对象。</p></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">traverseFileTree</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fileEntryList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> promises <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> fileEntryList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isFile<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 文件，使用 file() 函数获取文件对象</span>
        promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
          <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            entry<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">[</span>file<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isDirectory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 文件夹，使用 createReader() 函数获取目录所有文件 entry</span>
        <span class="token comment">// 然后再递归调用 traverseFileTree 函数</span>
        <span class="token keyword">const</span> dirReader <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">createReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
          <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            dirReader<span class="token punctuation">.</span><span class="token function">readEntries</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entries</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">traverseFileTree</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fileList</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>fileList<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8)),t(o,{id:"code-demo-158",type:"react",title:"%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE",code:"eJy1Vt1uFDcUfhWTXuxEyk62tEjNNgtCStsb1FaFO0DFmfHuupkdj2zvkrBaKbQUkpIAggJViYBIlKJWkLQXUEjSvMzOZHOVV+ixPb+bRK1Km4vs2D7nO+f4fP7s7shXYqQ64jBfSNRFbUFOSywJ6qEa+oJgR57zz/lkNmBcIpfUcduTyBpFteOoe85HyPiddTlufORLwseQIHIqGZ0HkATRqmNPkNGcU5165BQVUvt8HA8KLmfPg33m0cS+65EUHSwtkqWCELEDTjrEl1MmUUtHQ4WULMnbJovewdCfdf4v5FMEd8i/g8727kBsFrwdrFlqmC5MYYktYrvwc4ZjX9QJt6kkLbE/vuRQERdEuZ3hRBenugrofE51M58RJ7LNfeSTi+hzzlpUEMviRDCvU0g8wQ6MjQDMs+eTFBGqM44sYwHF8TnE6mgoZAqEEK3DtqgVmwqVZGERofFxFN271t94ube51N/a3vn+mcYCfofXtqK764Mbr8Kb94xJuPZ68Ntq3jvJ0A7aomnlV9A/qDL5M+npsHrvDrZS26dBLH1s1LkoLveGZorj3KCHCDS9sDNTlBNHMj532PaET15nO+RwAmcTtMEFBhV3aufBi3DrbrQ4H60sGk9T3hDozpWX4a0b4dXl3fnb4dbtwfo3CncfmQxy3tf03aXcRAdqmBKKKf33PUoj2hDIVVSjRFh6/+Dj7zo2XFjq9xZNTD7j46j+4lJs7HlWUvaoLZvEN8QaPo9xM8Klb8Nbv4Y3HoU/Xzf929m4Ez28oht+NfphLfp9Fdpplvrbq9Hltb3NhZQX4a3l8Pn9neeLe5uLGW5SehLXrnsYJCitICnM/MZFQDL5Awe9j5ZfZGKTkyelM0aScvUoRh+JZ43WJHuT8jhaiCk6eLUW/nklXLg/WH1mbEyMgpIUlCenOyqGkp041pBuGVWq6VX7IpmeofITIk8KDZuRMz1/hTNXiG84a4xy/S60XcVkHrE91igq7xgqac9S7LqPhEXRzPFkiM+KIk+/jh6u7K7MD55eBhmEs7uzOQ+NH2w/GKwuRY9Xd39ZArqEN9f6Gz/FKoGl5GXsOCSQKHxzJ4cWb6LfwR51VTpK4nVgpYLqWsoZI3Oh6JSOaA846Cc1rF4YQ3GMEydQKalVe6bXmr7zkueFqTAJlGGrD9vHLYKO1GqoZE+d/vI0KCIpKc7mUPt/fNfffAx0j+4s97dWDmBxfM3FRUy6tJPyw8NCfAoxat0L6sFUxqAmF9KjzPz0Yq51h546Q0bqjZK3UeMhE/3YyNvoiYIRC7J1FqRLQs554NlF04yD5FVR+rhDsMc+80kJVVHbh9cg9YmLerHn8QQgX3Oh6pKuGmhJeLmFxUwpjZmL6lIReHhuKOy0x5wZFTdOIAkKTUnjRtfvRde3YmVaWI+ePwmX3oSPHgE1U0XZvXZzb/PHbqpLHvEbspmCTba9FA6hzKyFg8Nu57jfkx5FM2Supn00k3rHc9+T4x7NIfdGs5DjaczJcdg5/Q2EAoORsRFHqNe5ndLFxA6YoJIyvwrRQVhph3yoplvUL1+krmxW0bFKJZhNJ5uENpqyit5LZ5PeHg1mkYtFE/r4juM4ubUyxy5tC4CKXerMl2VBLxHwSmAc5jFAiV31CTC5Zk0ezhhPg2C1pclYsqCKKvqTmxTNYJpJyVrJyCP1dOVSmQLzZqtoYmLC1Id5gyrctmSHlvbuBxOVev2g6sDKTGNnpsEZ0Bo2tTGNraPHKmMo+1exj40WSn6/MkE0pGpU7y+zzaj1"},{default:c(()=>a[20]||(a[20]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("dragEnter"),n("span",{class:"token punctuation"},","),s(" setDragEnter"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("fileList"),n("span",{class:"token punctuation"},","),s(" setFileList"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragEnter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragOver"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragLeave"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDrop"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token function"},"getFileData"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("dataTransfer"),n("span",{class:"token punctuation"},"."),s("items"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"traverseFileTree"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fileEntryList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" promises "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

      `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" entry "),n("span",{class:"token keyword"},"of"),s(" fileEntryList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},"."),s("isFile"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token comment"},"// 文件，使用 file() 函数获取文件对象"),s(`
          promises`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s(`
            `),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              entry`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"file"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),s("file"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
              `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},"."),s("isDirectory"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token comment"},"// 文件夹，使用 createReader() 函数获取目录所有文件 entry"),s(`
          `),n("span",{class:"token comment"},"// 然后再递归调用 traverseFileTree 函数"),s(`
          `),n("span",{class:"token keyword"},"const"),s(" dirReader "),n("span",{class:"token operator"},"="),s(" entry"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createReader"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
          promises`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s(`
            `),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              dirReader`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"readEntries"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"entries"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"traverseFileTree"),n("span",{class:"token punctuation"},"("),s("entries"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
              `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`

      Promise`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"all"),n("span",{class:"token punctuation"},"("),s("promises"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fileList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// 包含原始目录结构，但是没有目录信息（文件夹名字等）"),s(`
        `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),s("fileList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"flat"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 获取文件数据"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"getFileData"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`

    `),n("span",{class:"token comment"},"// 文件或目录路径列表"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" fileEntryList "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" item "),n("span",{class:"token keyword"},"of"),s(" items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" entry "),n("span",{class:"token operator"},"="),s(" item"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"webkitGetAsEntry"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        fileEntryList`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("fileEntryList"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'entry'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"traverseFileTree"),n("span",{class:"token punctuation"},"("),s("fileEntryList"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"files"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token comment"},"// 如果需要对后缀名进行校验，可以使用 attr-accept 库"),s(`
      `),n("span",{class:"token comment"},"// const invalidFiles = files.filter("),s(`
      `),n("span",{class:"token comment"},"//   (file) => !validateAccept(file, accept ?? '')"),s(`
      `),n("span",{class:"token comment"},"// )"),s(`

      `),n("span",{class:"token function"},"setFileList"),n("span",{class:"token punctuation"},"("),s("files"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"filter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" file"),n("span",{class:"token punctuation"},"."),s("name "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'.DS_Store'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

      `),n("span",{class:"token comment"},"// 上传等操作"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),s(`div
      className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"drag-area"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},"}"),s(`
      onDragEnter`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragEnter"),n("span",{class:"token punctuation"},"}"),s(`
      onDragOver`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragOver"),n("span",{class:"token punctuation"},"}"),s(`
      onDragLeave`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragLeave"),n("span",{class:"token punctuation"},"}"),s(`
      onDrop`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDrop"),n("span",{class:"token punctuation"},"}"),s(`
      style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"border"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s(`div
        className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"'drag-enter-mask'"),n("span",{class:"token punctuation"},"}"),s(`
        style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"display"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'block'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      拖拽文件到此区域，文件数量：`),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),s("ul"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token operator"},"<"),s("li key"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("li"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("ul"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("div"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-css line-numbers-mode","data-ext":"css","data-title":"css"},[n("pre",{class:"language-css"},[n("code",null,[n("span",{class:"token selector"},".drag-area"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" relative"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-width"),n("span",{class:"token punctuation"},":"),s(" 500px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-height"),n("span",{class:"token punctuation"},":"),s(" 300px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #ccc"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 5px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"font-size"),n("span",{class:"token punctuation"},":"),s(" 20px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #ccc"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token selector"},".drag-enter-mask"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" absolute"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"top"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"right"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"bottom"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"left"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"z-index"),n("span",{class:"token punctuation"},":"),s(" 999"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"margin"),n("span",{class:"token punctuation"},":"),s(" auto"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #1890ff"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 2px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"background"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token function"},"rgba"),n("span",{class:"token punctuation"},"("),s("250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 0.5"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #409eff"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[20]}),a[47]||(a[47]=p(`<div class="hint-container warning"><p class="hint-container-title">注意</p><p>以为拖拽上传就到此结束了吗？当然没有，还有一个 edge case 需要处理。</p></div><h4 id="拖拽文件数量超过-100-处理" tabindex="-1"><a class="header-anchor" href="#拖拽文件数量超过-100-处理"><span>拖拽文件数量超过 100 处理</span></a></h4><p>当文件夹中文件数量超过 100 个时，<code>readEntries</code> 方法只会返回 100 个文件，因此需要递归调用 <code>readEntries</code> 方法，直到返回空数组。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// dirReader.readEntries 每次只能读取 100 个文件，所以需要递归读取全部文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">readAllEntries</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dirReader<span class="token punctuation">,</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    dirReader<span class="token punctuation">.</span><span class="token function">readEntries</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entries</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>entries<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果还有文件，将其添加到 items 列表中并继续读取</span>
        items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>entries<span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">readAllEntries</span><span class="token punctuation">(</span>dirReader<span class="token punctuation">,</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果没有更多文件，则完成读取，并返回获取到的全部文件</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> dirReader <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">createReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
promises<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
  <span class="token function">readAllEntries</span><span class="token punctuation">(</span>dirReader<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entries</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">traverseFileTree</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)),t(o,{id:"code-demo-174",type:"react",title:"%E6%8B%96%E6%8B%BD%E6%96%87%E4%BB%B6%E6%95%B0%E9%87%8F%E8%B6%85%E8%BF%87%20100%20%E5%A4%84%E7%90%86",code:"eJy1V1tvE0cU/itD+pCNFG9cWqTGjUFIafuC2qrwBqhs7LG9zXp3tTM2CZalUAI4kEDEvSQCIlGIWoWkVRUITpo/41k7T/kLPTOzO3uJQ9NW9YM9l3O+cz9n3Bj4gQzkBgqOTShqoBrBZ6lBMWqiPPoOGwV6wb5g4ynX8Sgq4pJRsyjShlD+JGpcsBGSfOeLnlH+wqbYG0YE0/FwdxFAQkStZFgED8WYSqaFz5iECp4vg02C5fxFoI84KoZdtLBCB0oNR6oghHXXw3Vs03GpqCakoYRKGvVqUotmf+hv6v8X8hls1PG/g4581xfbcf8brLwqyyiMG9TQsF6En3OeYZMS9nST4io5KJ96YJFHMGc752FhHI8qoHvTPJpxjTxMa56NbHwZfes5VZNgTfMwcax6QvEQ25U0BDDPXwxVRKjkeEiTFGCcN42cEkqJVEAImSVwC7/RTcKVTFwiNDKC/Ec3O+3N/e35zs5u98GqwIL8Zjd3/IcbvTtv2d1HkoStb/V+W4lzhxrqbo1UtPgNOoKV4UeqJ8QK3/Wn4u4TIJooG14Xyetm6iS5j22aCEPQE54ZNz1coI43fZh72MutyEMFD0NtQm8oQgYlPdVdesN2HvpzM/7ynOSU5qVAu7ObbPEOu7GwN3OP7dzrbVzjuAeSSSLHeWXcQX7xtGXxiJsiP7Si6Ul9hpHIVJEz/Rx55BwMPwpZ51IDkZrwHCwOi1XoXCDRLWyXaSXl2Zgz2Ksf/WfLvd0nymfgarZxg13f9N+22a0XrLURWMVaj3srq513a2xrs9t+3W2v9dbb4PZ+yIJDZqau66G+/SjDxEq69YBPh/owB7n0YdP831e4aUt/sJdPIwNbP7E3835rUVrAT7Y2e7sP2NIzmUpgdffpLLu+undtVXJ9SPeoP6UU/GdlEjS38CPTTTkCskpWTLICjtoSDvPvkE4r2P6bnAoSN10jiumoxR8uY5YGhaAblqWF+oc6hSM6rRQP7vx1tvgru/Ocvb4t677bvu8/mxWN4ob/ZF3GXV51dlf8q+v72y3VT9jiAlt73F2b29+ei3DDeIZy9ZJlwOhSFoSGyd/ACFAm3qihZ/gLb6IhFRtrvFfIVInZw4v1WHAq3Rz6RvU/vxW0tt7bdfbnrKxDSSNlJCZQYmLF5hWXwcdVICs17+Q0y4tb/TKemDTpV5ieJgI2yjLVtxMdJSFfJp8kisU7EXYu07Gwbjnl5MQeRoOCczBgPZBxyWEby5NU5qr631ue6b26CuMTen53ewYC39td6q3M+y9W9n6Z55V/d73T/jmYLgalXsYoFLBLEXt/P4YWONGuG5ZZ5OrwNi8E8+nJnzMxYiQfIkKlY4IDKva0gBUXwyiQceoUGgxtFZxqnXYRAdeUCIFVRB97uEqaUJVIOl/otlHF6Fg+jwb18bPfn4VZCyDq4SXkdt7d6my/gILw7y90dpb75HnQAwIzx4pmXalqGYR8DTLyjUv8KZ4xoNlcUsXu2OrJl2+kHtEpIv76jdPwfYpEPGPjNOIgQeS40b3jqitCpy3gbKAJx4PGl0PqbwOCKNiOjQdRDtVs+J9h2riImgHnyRAgbnPC6kFhNSQu9jJVg0wOxhq/klo0iWsZ0ymxE5ZTmORyAwVCoRAUJde//ci/vRP0rtaGv/aSzb9nz59D8qqes3fz7v7204bqXHLuK7CxmqXgEIrIqoZ72LsviPeYZaJJPJ0XPCKTmidj67ERy4whN4cikSNK5tgIeE6sIaGAYGB4oED4/z5dpYuU7TrEpKZj50A6tF6zjj/nx1XTzlw2i7SSQyeyWXdKHVawWa7QHPpEnYaxPe5OoaJBKhDHjwqFQuwu4xlFs0YAKmApOTbNEPMKBq4QpuBYDqAErKICpK5RkNMaGxNQrzUqNaaOm0NZsfSkinIz4VDqVMOdhUvq5krGhMybyqHR0VFpn+GVTY5bo86hpn382Wi2VOpnHVDJY6MwWfYcSGtwannC0I6fyA6j6CurnxhKmPxpdhQLSB6o5l/2UIat"},{default:c(()=>a[21]||(a[21]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("dragEnter"),n("span",{class:"token punctuation"},","),s(" setDragEnter"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("fileList"),n("span",{class:"token punctuation"},","),s(" setFileList"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragEnter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragOver"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragLeave"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDrop"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token function"},"getFileData"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("dataTransfer"),n("span",{class:"token punctuation"},"."),s("items"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"traverseFileTree"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fileEntryList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" promises "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

      `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" entry "),n("span",{class:"token keyword"},"of"),s(" fileEntryList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},"."),s("isFile"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token comment"},"// 文件，使用 file() 函数获取文件对象"),s(`
          promises`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s(`
            `),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              entry`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"file"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),s("file"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
              `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},"."),s("isDirectory"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token comment"},"// 文件夹，使用 createReader() 函数获取目录所有文件 entry"),s(`
          `),n("span",{class:"token comment"},"// 然后再递归调用 traverseFileTree 函数"),s(`
          `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"readAllEntries"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("dirReader"),n("span",{class:"token punctuation"},","),s(" items "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              dirReader`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"readEntries"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"entries"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entries"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                  `),n("span",{class:"token comment"},"// 如果还有文件，将其添加到 items 列表中并继续读取"),s(`
                  items`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"..."),s("entries"),n("span",{class:"token punctuation"},")"),s(`
                  `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"readAllEntries"),n("span",{class:"token punctuation"},"("),s("dirReader"),n("span",{class:"token punctuation"},","),s(" items"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
                  `),n("span",{class:"token comment"},"// 如果没有更多文件，则完成读取，并返回获取到的全部文件"),s(`
                  `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),s("items"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(`
              `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},"}"),s(`

          `),n("span",{class:"token keyword"},"const"),s(" dirReader "),n("span",{class:"token operator"},"="),s(" entry"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createReader"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
          promises`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s(`
            `),n("span",{class:"token function"},"readAllEntries"),n("span",{class:"token punctuation"},"("),s("dirReader"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"entries"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"traverseFileTree"),n("span",{class:"token punctuation"},"("),s("entries"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`

      Promise`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"all"),n("span",{class:"token punctuation"},"("),s("promises"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fileList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// 包含原始目录结构，但是没有目录信息（文件夹名字等）"),s(`
        `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),s("fileList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"flat"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 获取文件数据"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"getFileData"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`

    `),n("span",{class:"token comment"},"// 文件或目录路径列表"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" fileEntryList "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" item "),n("span",{class:"token keyword"},"of"),s(" items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" entry "),n("span",{class:"token operator"},"="),s(" item"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"webkitGetAsEntry"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        fileEntryList`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("fileEntryList"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'entry'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"traverseFileTree"),n("span",{class:"token punctuation"},"("),s("fileEntryList"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"files"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token comment"},"// 如果需要对后缀名进行校验，可以使用 attr-accept 库"),s(`
      `),n("span",{class:"token comment"},"// const invalidFiles = files.filter("),s(`
      `),n("span",{class:"token comment"},"//   (file) => !validateAccept(file, accept ?? '')"),s(`
      `),n("span",{class:"token comment"},"// )"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("files"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'fssile'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token function"},"setFileList"),n("span",{class:"token punctuation"},"("),s("files"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"filter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" file"),n("span",{class:"token punctuation"},"."),s("name "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'.DS_Store'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

      `),n("span",{class:"token comment"},"// 上传等操作"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),s(`div
      className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"drag-area"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},"}"),s(`
      onDragEnter`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragEnter"),n("span",{class:"token punctuation"},"}"),s(`
      onDragOver`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragOver"),n("span",{class:"token punctuation"},"}"),s(`
      onDragLeave`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragLeave"),n("span",{class:"token punctuation"},"}"),s(`
      onDrop`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDrop"),n("span",{class:"token punctuation"},"}"),s(`
      style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"border"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s(`div
        className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"'drag-enter-mask'"),n("span",{class:"token punctuation"},"}"),s(`
        style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"display"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'block'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      拖拽文件到此区域，文件数量：`),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),s("ul"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token operator"},"<"),s("li key"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("li"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("ul"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("div"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-css line-numbers-mode","data-ext":"css","data-title":"css"},[n("pre",{class:"language-css"},[n("code",null,[n("span",{class:"token selector"},".drag-area"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" relative"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-width"),n("span",{class:"token punctuation"},":"),s(" 500px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-height"),n("span",{class:"token punctuation"},":"),s(" 300px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #ccc"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 5px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"font-size"),n("span",{class:"token punctuation"},":"),s(" 20px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #ccc"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token selector"},".drag-enter-mask"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" absolute"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"top"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"right"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"bottom"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"left"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"z-index"),n("span",{class:"token punctuation"},":"),s(" 999"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"margin"),n("span",{class:"token punctuation"},":"),s(" auto"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #1890ff"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 2px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"background"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token function"},"rgba"),n("span",{class:"token punctuation"},"("),s("250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 0.5"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #409eff"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[21]}),a[48]||(a[48]=p(`<div class="hint-container warning"><p class="hint-container-title">注意</p><p>你以为又结束了吗？此时产品跑过来和你说需要保留文件目录结构，但是上面已经说过，<code>DataTransfer.items</code> 属性只能返回文件列表，因此需要自己实现文件路径信息。</p></div><h4 id="保留文件目录结构" tabindex="-1"><a class="header-anchor" href="#保留文件目录结构"><span>保留文件目录结构</span></a></h4><p>思考一下如何保留文件目录结构，只需要保留文件目录信息即可，剩下的事情就交给后端进行解析。</p><p>看一下拖拽上传后的获取的 <code>File</code> 对象，其中的 <code>webkitRelativePath</code> 竟然是一个空值：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">lastModified</span><span class="token operator">:</span> <span class="token number">1691144702000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">lastModifiedDate</span><span class="token operator">:</span> Fri Aug <span class="token number">04</span> <span class="token number">2023</span> <span class="token number">18</span><span class="token operator">:</span><span class="token number">25</span><span class="token operator">:</span><span class="token number">02</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0800</span> <span class="token punctuation">(</span>中国标准时间<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;2083_00008.png&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">118241</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">webkitRelativePath</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span>Prototype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> File
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)),n("div",w,[a[26]||(a[26]=n("p",{class:"hint-container-title"},"注意",-1)),n("p",null,[n("a",h,[a[22]||(a[22]=n("code",null,"webkitRelativePath",-1)),t(e)]),a[23]||(a[23]=s(" 属性记录了文件的路径，但是该属性只有在使用 ")),a[24]||(a[24]=n("code",null,"input",-1)),a[25]||(a[25]=s(" 上传时才会有值，因此需要自己实现该属性。"))])]),n("p",null,[a[28]||(a[28]=s("那么如何实现该属性，")),n("a",E,[a[27]||(a[27]=s("FileSystemEntry")),t(e)]),a[29]||(a[29]=s(" 对象上会有一个 ")),a[30]||(a[30]=n("code",null,"name",-1)),a[31]||(a[31]=s(" 属性，记录了路径的名字。"))]),a[49]||(a[49]=n("p",null,[s("因此只需要在 "),n("code",null,"traverseFileTree"),s(" 函数中，将文件路径信息保存到 "),n("code",null,"File"),s(" 对象上的 "),n("code",null,"webkitRelativePath"),s(" 中即可。")],-1)),a[50]||(a[50]=n("p",null,"下面看完整实现：",-1)),t(o,{id:"code-demo-207",type:"react",title:"%E8%BF%98%E5%8E%9F%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84",code:"eJy1V1tvE0cU/itD+uCNcDYuLVLjxiCktH1BBQFvgMrYHttL1rur2bETY1kKJYADCUTcSyIgEoWoVUhaVYHgpPkz3rXzlL/QMzN7tR2atqofkt2Zc75zv2x96Ko9lB7KmYbNUB1VbHKeYUZQA2XQOYJz7JJxySDTlkkZypMCrugMKcMocwLVLxkISb6LeYqL3xiM0CSyCZvw3y4DiI+oFLBuk+EIU0HTyWnNZoLnW+8lxnLxMtCHHCVs5HUSoAOlQkJVECKqRUmVGGxCKqoIaSimksJoRWrRGAx9pvp/IZ8muEr+HXTou4HYpvXfYOVVUUZhAjOsEDUP/y5QbNgFQlWNkbLdL59RsIjahLNdoEQYx6MK6LQmQ0uJjplWJWcxK8F1IhFVkhJWoQYyyBQ6S82yZhNFocQ29WrMFl+cJWlswLl42dcaoYJJkSIpwF5aQ2YBxbQYDoF8KEF4Lq5bTNWjkkQ1cJmEzFoB3CzONZsbHUNGaHQUuU9ut1ub+9vz7Z3dzqNVoQjUi3N7x3280b333rn/RJI461vd31ai3L55qlWxS0r0Bh3CRf5PqifEilgMpkLoTPYqyTEValozCEBbhLKa4EiixBTJTmos6p9EchAIQlWsV0i635/JQcRTVGM4qwO9yLx+koaXpdGfZ60i+gVvCJ9mib9HXhqIgMxYCCc0Cj4wae2gODqvt8JQ5iiBpgRNMQ+lEw9pZ+mds/PYnZtxl+ckp/RID2hndtNZvOfcWtibeeDsPOhu3OC4fVUkkaO8MmlBfv6UrvO81kQVKHmNSn2SSJSoqIxBET90pfm/AFnlUj2RivAcPByUVL5zgUTViVFkpR7PRpzhvPnRfbHc3X0W+Axc7Wzccm5uuu9bzp1XTnPDs8ppPu2urLY/rDlbm53W205rrbveArcPQhYcsoRUVfX1HUTpJ1bcrX0+HR7A7OXSp01zf1/hpi394bx+HhrY/Ml5N+82F6UF/GRrs7v7yFl6IVMJrO48n3Vuru7dWJVcn9I9bMw9Cv6zMvG6uv+T6RY4ArJKVky8Ag7buw7y77DKSsT4m5zyEre3Rnym5IBOfhQlRhOH7gr+Y8QFXoWoWNcV3zBfWX9p6dWWR33+prP4q3PvpfP2rmwIndZD98Ws6CC33GfrMiHkVXt3xb2+vr/dDBqNs7jgrD3trM3tb8+FuH6gfblqASxVwpz0DZP/PSNAmeiogWbiLrwLx3Zk0PMmInMoYg+v4iPeqfS/75ugMbpNr+d13687f87KApU0UkZsAMcGdmRccxl8Wnuyesa9HOYZcavKifQdYadsARumX9DQY60mJl9mpSSKxDsWdi7T1Imqm8XeHSYhOP2U6kvF+K4RyZOelA4aw97yTPfNdVgAYBh0tmcg8N3dpe7KvPtqZe+Xed4S7q+3Wz97YwczRkdwLkcshpyPDyNonhMNmMFanqvD+78QzOc/X/AixEiuZkKlI4IDSvmUgPWmvifj5Em+pUU4g+deF0H1JQq2DU8hfWSVlzS+KqF0/iD2KnQkAxuhOnH+h/MwhAEkWEWF3PaHO+3tV1AQ7sOF9s7ygDz3moNn5nheqwaq6ti2vwcZmfoV/nEygqELXQmK3TSCJThT7/ms6CHi3wNRGv7eQyIW+yiNOIgRmVZ4b1rBlc1qOnDWUdak0BHTKPiQQhAFwzRIAqVRxZBbWh41PM4TPkDU5pjVCWE1JC6hI2VsTyYiEyGQmtdsS8e1HrFZ3cxNcrmeAr5QCEog1737xL274/Wu5oa79tqZ/+i8fAnJG/Scvdv397ef14POJReCAGy8ogdwCIVkZWwdtLl68R7XNTRJahnBIzKpcUI+9++tjfFRXYvIaQyHCowGGoyPgh/FM6QXEAwlh3I2/y5Wg+SRmlimrTHNNNLB18LX/LisGSNTWp6V0uh4KmVNB4clohVLLI2+CE79SB+zplEe2yWI6me5XC5yN0JxXqvYAOWxFEyDjdjaNdibj/kwOVM3AcVjFfUgdQ1D3qsxzkL1VpjUmJlWGqXEI5UqypesyZhZ9t90Ughuro1okIfTaTQ2Nibtw7SocdwKMw807fOvxlKFwiDrgEoe49xkkZqQ5ODUYhYrx46nkij8k1KPD8dM/jI1RgQkD1TjL9sr3eA="},{default:c(()=>a[32]||(a[32]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("dragEnter"),n("span",{class:"token punctuation"},","),s(" setDragEnter"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("fileList"),n("span",{class:"token punctuation"},","),s(" setFileList"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragEnter"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragOver"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDragLeave"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"handleDrop"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    e`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"preventDefault"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"setDragEnter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token function"},"getFileData"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("dataTransfer"),n("span",{class:"token punctuation"},"."),s("items"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(" traverseFileTree "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),s("fileEntryList"),n("span",{class:"token punctuation"},","),s(" relativePath "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" promises "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

      `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" entry "),n("span",{class:"token keyword"},"of"),s(" fileEntryList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"const"),s(" entryRelativePath "),n("span",{class:"token operator"},"="),s(" relativePath "),n("span",{class:"token operator"},"+"),s(" entry"),n("span",{class:"token punctuation"},"."),s(`name
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},"."),s("isFile"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token comment"},"// 文件，使用 file() 函数获取文件对象"),s(`
          promises`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s(`
            `),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              entry`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"file"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                Object`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"defineProperty"),n("span",{class:"token punctuation"},"("),s("file"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'webkitRelativePath'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
                  `),n("span",{class:"token literal-property property"},"value"),n("span",{class:"token operator"},":"),s(" entryRelativePath"),n("span",{class:"token punctuation"},","),s(`
                  `),n("span",{class:"token literal-property property"},"writable"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),s(`
                `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),s("file"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
              `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},"."),s("isDirectory"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token comment"},"// 文件夹，使用 createReader() 函数获取目录所有文件 entry"),s(`
          `),n("span",{class:"token comment"},"// 然后再递归调用 traverseFileTree 函数"),s(`
          `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"readAllEntries"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("dirReader"),n("span",{class:"token punctuation"},","),s(" items "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Promise"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"resolve"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              dirReader`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"readEntries"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"entries"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entries"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
                  `),n("span",{class:"token comment"},"// 如果还有文件，将其添加到 items 列表中并继续读取"),s(`
                  items`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"..."),s("entries"),n("span",{class:"token punctuation"},")"),s(`
                  `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"readAllEntries"),n("span",{class:"token punctuation"},"("),s("dirReader"),n("span",{class:"token punctuation"},","),s(" items"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
                  `),n("span",{class:"token comment"},"// 如果没有更多文件，则完成读取，并返回获取到的全部文件"),s(`
                  `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),s("items"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token punctuation"},"}"),s(`
              `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},"}"),s(`

          `),n("span",{class:"token keyword"},"const"),s(" dirReader "),n("span",{class:"token operator"},"="),s(" entry"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createReader"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
          promises`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s(`
            `),n("span",{class:"token function"},"readAllEntries"),n("span",{class:"token punctuation"},"("),s("dirReader"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"entries"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
              `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"traverseFileTree"),n("span",{class:"token punctuation"},"("),s("entries"),n("span",{class:"token punctuation"},","),s(" entryRelativePath "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},"'/'"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`

      Promise`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"all"),n("span",{class:"token punctuation"},"("),s("promises"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fileList"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token comment"},"// 包含原始目录结构，但是没有目录信息（文件夹名字等）"),s(`
        `),n("span",{class:"token function"},"resolve"),n("span",{class:"token punctuation"},"("),s("fileList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"flat"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token comment"},"// 获取文件数据"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"getFileData"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(`

    `),n("span",{class:"token comment"},"// 文件或目录路径列表"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" fileEntryList "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" item "),n("span",{class:"token keyword"},"of"),s(" items"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" entry "),n("span",{class:"token operator"},"="),s(" item"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"webkitGetAsEntry"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        fileEntryList`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("entry"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("fileEntryList"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'entry'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token function"},"traverseFileTree"),n("span",{class:"token punctuation"},"("),s("fileEntryList"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"then"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"files"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token comment"},"// 如果需要对后缀名进行校验，可以使用 attr-accept 库"),s(`
      `),n("span",{class:"token comment"},"// const invalidFiles = files.filter("),s(`
      `),n("span",{class:"token comment"},"//   (file) => !validateAccept(file, accept ?? '')"),s(`
      `),n("span",{class:"token comment"},"// )"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s("files"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},"'fssile'"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token function"},"setFileList"),n("span",{class:"token punctuation"},"("),s("files"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"filter"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" file"),n("span",{class:"token punctuation"},"."),s("name "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'.DS_Store'"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

      `),n("span",{class:"token comment"},"// 上传等操作"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),s(`div
      className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"drag-area"),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},"}"),s(`
      onDragEnter`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragEnter"),n("span",{class:"token punctuation"},"}"),s(`
      onDragOver`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragOver"),n("span",{class:"token punctuation"},"}"),s(`
      onDragLeave`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDragLeave"),n("span",{class:"token punctuation"},"}"),s(`
      onDrop`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("handleDrop"),n("span",{class:"token punctuation"},"}"),s(`
      style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"border"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token keyword"},"undefined"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s(`div
        className`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"'drag-enter-mask'"),n("span",{class:"token punctuation"},"}"),s(`
        style`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"display"),n("span",{class:"token operator"},":"),s(" dragEnter "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'block'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'none'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      拖拽文件到此区域，文件数量：`),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),s("ul"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token operator"},"<"),s("li key"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("webkitRelativePath"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("li"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("ul"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("div"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-css line-numbers-mode","data-ext":"css","data-title":"css"},[n("pre",{class:"language-css"},[n("code",null,[n("span",{class:"token selector"},".drag-area"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" relative"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-width"),n("span",{class:"token punctuation"},":"),s(" 500px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-height"),n("span",{class:"token punctuation"},":"),s(" 300px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #ccc"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 5px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"font-size"),n("span",{class:"token punctuation"},":"),s(" 20px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #ccc"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token selector"},".drag-enter-mask"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"position"),n("span",{class:"token punctuation"},":"),s(" absolute"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"top"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"right"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"bottom"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"left"),n("span",{class:"token punctuation"},":"),s(" 0"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"z-index"),n("span",{class:"token punctuation"},":"),s(" 999"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"margin"),n("span",{class:"token punctuation"},":"),s(" auto"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #1890ff"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 2px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"background"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token function"},"rgba"),n("span",{class:"token punctuation"},"("),s("250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 250"),n("span",{class:"token punctuation"},","),s(" 0.5"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #409eff"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[32]}),a[51]||(a[51]=p(`<div class="hint-container warning"><p class="hint-container-title">注意</p><p>到此，拖拽上传就已经全部实现完，但是由于使用的都是最新标准，如果使用 ts 可能会有类型报错：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>error TS2304: Cannot <span class="token function">find</span> name <span class="token string">&#39;FileSystemEntry&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>因此需要自定义类型：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IFileSystemEntry</span> <span class="token punctuation">{</span>
  isFile<span class="token operator">:</span> <span class="token builtin">boolean</span>
  isDirectory<span class="token operator">:</span> <span class="token builtin">boolean</span>
  file<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  createReader<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span> <span class="token comment">// 为了方便使用 any，也可以创建具体类型</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="粘贴上传" tabindex="-1"><a class="header-anchor" href="#粘贴上传"><span>粘贴上传</span></a></h2><p>经历过拖拽上传的痛苦折磨后，实现粘贴上传相信也不在话下了。</p><p>只需要监听 <code>paste</code> 事件，<code>clipboardData</code> 中包含了粘贴的文件数据。</p>`,4)),t(o,{id:"code-demo-230",type:"react",title:"%E7%B2%98%E8%B4%B4%E4%B8%8A%E4%BC%A0",code:"eJyVUz1vEzEY/itvj6EX6XKpQCwhSYVEmRBDGZMOru+9xuD4TrYvpJxuLkMlJhBi6cKKVKGKAfpzSICpfwHfh3NOlKUezl/P87yPH/ty77Xy+h5NhNKQQ6bwlSYag3J0jHHVH8UxUg0FDOEYCdUTMRG4SBOpIcKYZFyD34HhCPKJAKilUqJ0KWA4tZIvMs47LWAcM44vmNIBKNTPm8lJja88+OMTg9+SPJqj0CUSBUoD9rGtDMBi8Pf2MKScpacJkdEzoslhWJZShyFHcaanHQu2utWukXoqJTkPY5nM/C2FWqAyXzbHr+/uFGVnPmW3js13oqkN2mhCmklpTuMY2t4KSRRtnNjfryD7wY40AogJV+iaAZCoMync+9lZR+IsmW/K3bNUEcB4F9CWsndpDdXUQcTmI+uqnADlRKmXZIbDiVdxu0QimXiGGA9zq1asSQB/vn/+e3Oz+nTx+9eP5fvr1bevy8ufy6uru9vLenH18frfxYe72y+5fXPNU2gyqmpn3JEEaKEzkvrVNW9GWLfmNAPO4A2eDytWKIz7YuSMBz3ONtSLjlu659Qe9NpE2rHJzhC8wKOq/FvDNpja0IyJ7lsW6WkfHh8cpIsndnGK7Gyq+/BovXqayAhlHx6mC4iImmIEDyilzl5Xkohlykg1lDgRuqvYOzQsK0MTnhiVhlqaK/4D1/Z2WQ=="},{default:c(()=>a[33]||(a[33]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState"),n("span",{class:"token punctuation"},","),s(" useRef"),n("span",{class:"token punctuation"},","),s(" useEffect "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" pasteRef "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useRef"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("fileList"),n("span",{class:"token punctuation"},","),s(" setFileList"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"pasteEventListener"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"!"),s("e"),n("span",{class:"token punctuation"},"."),s("clipboardData"),n("span",{class:"token operator"},"?."),s("files"),n("span",{class:"token operator"},"?."),s("length"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" files "),n("span",{class:"token operator"},"="),s(" Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"from"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("clipboardData"),n("span",{class:"token punctuation"},"."),s("files"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token function"},"setFileList"),n("span",{class:"token punctuation"},"("),s("files"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("pasteRef"),n("span",{class:"token punctuation"},"."),s("current"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      pasteRef`),n("span",{class:"token punctuation"},"."),s("current"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"addEventListener"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'paste'"),n("span",{class:"token punctuation"},","),s(" pasteEventListener"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      pasteRef`),n("span",{class:"token punctuation"},"."),s("current"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"removeEventListener"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'paste'"),n("span",{class:"token punctuation"},","),s(" pasteEventListener"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"["),s("pasteEventListener"),n("span",{class:"token punctuation"},","),s(" pasteRef"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),s("div"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("div className"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"paste-area"'),s(" ref"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("pasteRef"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),s(`
        粘贴文件到此区域，文件数量：`),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s("ul"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token punctuation"},"{"),s("fileList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"file"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token operator"},"<"),s("li key"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("file"),n("span",{class:"token punctuation"},"."),s("name"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("li"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("ul"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("div"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("div"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),n("div",{class:"language-css line-numbers-mode","data-ext":"css","data-title":"css"},[n("pre",{class:"language-css"},[n("code",null,[n("span",{class:"token selector"},".paste-area"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},"min-width"),n("span",{class:"token punctuation"},":"),s(" 500px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"min-height"),n("span",{class:"token punctuation"},":"),s(" 300px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border"),n("span",{class:"token punctuation"},":"),s(" 2px dashed #ccc"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"border-radius"),n("span",{class:"token punctuation"},":"),s(" 5px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"font-size"),n("span",{class:"token punctuation"},":"),s(" 20px"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token property"},"color"),n("span",{class:"token punctuation"},":"),s(" #ccc"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1,__:[33]}),a[52]||(a[52]=n("div",{class:"hint-container warning"},[n("p",{class:"hint-container-title"},"注意"),n("p",null,"粘贴上传一般不会有特别复杂的场景，一般是粘贴一个图片或者文件，因此这里没考虑文件夹上传等场景。")],-1))])}const L=i(k,[["render",D],["__file","003-file-upload.html.vue"]]),A=JSON.parse('{"path":"/frontend/practice/003-file-upload.html","title":"常见文件上传场景","lang":"zh-CN","frontmatter":{"title":"常见文件上传场景","date":"2023-12-28T00:00:00.000Z","icon":"wenjianshangchuan","category":["practice"],"tag":["frontend","文件上传"],"description":"文件上传是前端开发中常见的需求，不管业务如何复杂，最关键的步骤在于如何获取文件数据，这里介绍几种常见的文件上传场景。 选择上传 拖拽上传 粘贴上传 选择上传 单文件 通过 input 标签的 type 属性设置为 file，然后监听 change 事件，获取文件数据。 多文件 通过 input 标签的 multiple 属性设置为 true，然后监听 ...","head":[["meta",{"property":"og:url","content":"https://dribble-njr.github.io/blog/blog/frontend/practice/003-file-upload.html"}],["meta",{"property":"og:title","content":"常见文件上传场景"}],["meta",{"property":"og:description","content":"文件上传是前端开发中常见的需求，不管业务如何复杂，最关键的步骤在于如何获取文件数据，这里介绍几种常见的文件上传场景。 选择上传 拖拽上传 粘贴上传 选择上传 单文件 通过 input 标签的 type 属性设置为 file，然后监听 change 事件，获取文件数据。 多文件 通过 input 标签的 multiple 属性设置为 true，然后监听 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-06T15:43:46.000Z"}],["meta",{"property":"article:author","content":"njr"}],["meta",{"property":"article:tag","content":"frontend"}],["meta",{"property":"article:tag","content":"文件上传"}],["meta",{"property":"article:published_time","content":"2023-12-28T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-06T15:43:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"常见文件上传场景\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-12-28T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-06T15:43:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"njr\\",\\"url\\":\\"https://github.com/dribble-njr/blog\\",\\"email\\":\\"wzw15292257101@163.com\\"}]}"]]},"headers":[{"level":2,"title":"1 选择上传","slug":"选择上传","link":"#选择上传","children":[{"level":3,"title":"1.1 单文件","slug":"单文件","link":"#单文件","children":[]},{"level":3,"title":"1.2 多文件","slug":"多文件","link":"#多文件","children":[]},{"level":3,"title":"1.3 目录上传","slug":"目录上传","link":"#目录上传","children":[]}]},{"level":2,"title":"2 拖拽上传","slug":"拖拽上传","link":"#拖拽上传","children":[{"level":3,"title":"2.1 实现拖拽区域交互","slug":"实现拖拽区域交互","link":"#实现拖拽区域交互","children":[]},{"level":3,"title":"2.2 DataTransfer","slug":"datatransfer","link":"#datatransfer","children":[]},{"level":3,"title":"2.3 获取文件路径","slug":"获取文件路径","link":"#获取文件路径","children":[]},{"level":3,"title":"2.4 递归获取文件","slug":"递归获取文件","link":"#递归获取文件","children":[{"level":4,"title":"2.4.1 拖拽文件数量超过 100 处理","slug":"拖拽文件数量超过-100-处理","link":"#拖拽文件数量超过-100-处理","children":[]},{"level":4,"title":"2.4.2 保留文件目录结构","slug":"保留文件目录结构","link":"#保留文件目录结构","children":[]}]}]},{"level":2,"title":"3 粘贴上传","slug":"粘贴上传","link":"#粘贴上传","children":[]}],"git":{"createdTime":1704622731000,"updatedTime":1730907826000,"contributors":[{"name":"dribble-njr","email":"wzw15292257101@163.com","commits":2}]},"readingTime":{"minutes":13.01,"words":3902},"filePathRelative":"frontend/practice/003-file-upload.md","localizedDate":"2023年12月28日","excerpt":"","autoDesc":true}');export{L as comp,A as data};
