import{_ as k,c as d,e as l,b as t,a as n,w as o,d as s,r as i,o as m}from"./app-Bq0FCg7h.js";const v={},g={class:"hint-container tip"},b={href:"https://github.com/facebook/react/issues/11527",target:"_blank",rel:"noopener noreferrer"},f={href:"https://react.dev/reference/react/useState#adding-state-to-a-component",target:"_blank",rel:"noopener noreferrer"},y={href:"https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state",target:"_blank",rel:"noopener noreferrer"},h={href:"https://react.dev/reference/react/useState#updating-objects-and-arrays-in-state",target:"_blank",rel:"noopener noreferrer"},S={href:"https://react.dev/reference/react/useState#avoiding-recreating-the-initial-state",target:"_blank",rel:"noopener noreferrer"},x={href:"https://react.dev/reference/react/useState#resetting-state-with-a-key",target:"_blank",rel:"noopener noreferrer"},w={href:"https://react.dev/reference/react/useState#storing-information-from-previous-renders",target:"_blank",rel:"noopener noreferrer"};function T(A,a){const u=i("CodeDemo"),r=i("Tabs"),e=i("ExternalLinkIcon");return m(),d("div",null,[a[12]||(a[12]=l(`<p><code>useState</code> 声明一个可以直接更新的状态变量。</p><p>一般在组件 <strong>最顶层</strong> 调用 <code>useState</code> 给组件添加状态变量，一般使用数组解构来命名状态变量，如 <code>[something, setSomething]</code>。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>

<span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&#39;Taylor&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">createTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="usestate-initialstate" tabindex="-1"><a class="header-anchor" href="#usestate-initialstate"><span>useState(initialState)</span></a></h2><p><strong>参数：</strong></p><p><code>initialState</code>：初始状态，可以是任何类型的值，初始渲染后，该参数将被忽略。</p><p>如果传递一个函数作为 <code>initialState</code>，它将被视为「初始化函数」。</p><p>它应该：</p><ul><li>是 <strong>纯函数</strong></li><li>不带参数</li><li>返回任意类型的值</li></ul><p>React 将在初始化组件时调用初始化函数，并将其返回值存储为初始状态。</p>`,10)),t(r,{id:"42",data:[{id:"直接传入值"},{id:"传入初始化函数"}]},{title0:o(({value:p,isActive:c})=>a[0]||(a[0]=[s("直接传入值")])),title1:o(({value:p,isActive:c})=>a[1]||(a[1]=[s("传入初始化函数")])),tab0:o(({value:p,isActive:c})=>[t(u,{id:"code-demo-44",type:"react",title:"%E7%9B%B4%E6%8E%A5%E4%BC%A0%E5%85%A5%E5%80%BC",code:"eJxtUsFu2zAM/RUiF8tI4KzXzAkwDDsU2KnbLc7BtelErSoFNlW0MPTvpaTItYvyYEp85BMf6XH1NKx2q8bogWAEO+A/qgk3/vSAXfB/ug4bAgd7eMC6oUpXurO6IWk0ND1y/r2WJGv137RmEDmMlQaInHKGMMHx5KHO9CAUMsqhHz/ZlXDn/Xp9K4ZFYXG1w0XcAIbaHchNuhG+0Q6ye8IXyGANQvLnLo+wC96lfozCQpmzyHrULfYZox7qkWyvF09WmosqjW9X0xO02NVWEUyyfc5fOdBS7JF86QYGpEByYnlppOK7SYXuUi3riKV8WFRmX/oUUVt5SCMopb5agtdaWdyPnsiB0b8vtT7zXWAO+0NiFlhQ3Z+RipCeO9h+8jxaIhOeisYkSjbPzBEopg14S3yhu2U4iDvOo7CsTVsM8yoU6jNdpoUmi4v13yXivmQWRRF45tHTrCcX1u9tEgrwq20n1dso+3MMVs0yx9jkS30VQvJPFiZxW8EtX0l4xvf96OFCtu4QT2ER5VbJGVueT92U2+mdMu6Am2Z05T4ALJARjg=="},{default:o(()=>a[2]||(a[2]=[n("p",null,[s("这个例子 "),n("strong",null,"没有"),s(" 传递初始化函数，因此 "),n("code",null,"createInitialTodos"),s(" 函数会在每次渲染时运行，比如当你在输入框中输入时，此时打开控制台，可以看到每次输入都会调用该函数。")],-1),n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState"),n("span",{class:"token punctuation"},","),s(" useRef"),n("span",{class:"token punctuation"},","),s(" useEffect "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"createInitialTodos"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" initialTodos "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(),n("span",{class:"token number"},"10"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    initialTodos`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"id"),n("span",{class:"token operator"},":"),s(" i"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"text"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Item '"),s(),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token punctuation"},"("),s("i "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'render'"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` initialTodos
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"TodoList"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("todos"),n("span",{class:"token punctuation"},","),s(" setTodos"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"createInitialTodos"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("text"),n("span",{class:"token punctuation"},","),s(" setText"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("input value"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("text"),n("span",{class:"token punctuation"},"}"),s(" onChange"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setText"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s(`button
        onClick`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token function"},"setText"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token function"},"setTodos"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),s(`
            `),n("span",{class:"token punctuation"},"{"),s(`
              `),n("span",{class:"token literal-property property"},"id"),n("span",{class:"token operator"},":"),s(" todos"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},","),s(`
              `),n("span",{class:"token literal-property property"},"text"),n("span",{class:"token operator"},":"),s(` text
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token operator"},"..."),s(`todos
          `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},">"),s(`
        Add
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("button"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("ul"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"{"),s("todos"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"item"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),s(`
          `),n("span",{class:"token operator"},"<"),s("li key"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("item"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("item"),n("span",{class:"token punctuation"},"."),s("text"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("li"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("ul"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1})]),tab1:o(({value:p,isActive:c})=>[t(u,{id:"code-demo-52",type:"react",title:"%E4%BC%A0%E5%85%A5%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0",code:"eJxlUsFu2zAM/RUiF8tI4KzXzAkwDDsU2KnbLc7BtelErSoFNlW0MPTvpaTItVsdRImPfOIjNa6ehtVu1Rg9EIxgB/xHNeHGnx6wC/ZP12FD4GAPD1g3VOlKd1Y3JI2GpkeOv9eSZK3+m9YMIoex0gCRU84QJjiePNSZHoRCRtn14yebEu68Xa9vybBILK52uIgbwFC7A7lJN8I32kF2T/gCGaxBSN7u8gi7YF2qxygslDmLrEfdYp8x6qEeyfZ68WSlOanS+HY1PUGLXW0VwSTbx/yVAy3FHsmnbmBACiQnlpdaKr53KtSWMllFTOTDIi/7UqWIyspDakAp9dUSvNbK4n70RA6M/n2p9ZnvAnPYHxKzwILq/oxUhPDcwfaT59ESmfBUXEyiZPPMHIFi6r9fiS9Ut3SHT3Cce2GZm2YYulUo1Ge6TONMK47V70vEfYksiiLwzL2nWU0uDN+vSSjAr7adVG+j7M82WDWLHGORL/VVCMlfLHTiNoJbvJLwjO/70cOFbN0hnsIgyq2SM7Y8n6opt9M7ZZwBF83oyn0Ag7QRPQ=="},{default:o(()=>a[3]||(a[3]=[n("p",null,[s("这个例子传递了初始化函数，因此 "),n("code",null,"createInitialTodos"),s(" 函数仅在初始化期间运行。当组件重新渲染，例如你在输入框中键入内容时，它不会再次运行。")],-1),n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState"),n("span",{class:"token punctuation"},","),s(" useRef"),n("span",{class:"token punctuation"},","),s(" useEffect "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"createInitialTodos"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" initialTodos "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(),n("span",{class:"token number"},"10"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    initialTodos`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token literal-property property"},"id"),n("span",{class:"token operator"},":"),s(" i"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token literal-property property"},"text"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Item '"),s(),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token punctuation"},"("),s("i "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'render'"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` initialTodos
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"TodoList"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("todos"),n("span",{class:"token punctuation"},","),s(" setTodos"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),s("createInitialTodos"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("text"),n("span",{class:"token punctuation"},","),s(" setText"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("input value"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("text"),n("span",{class:"token punctuation"},"}"),s(" onChange"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setText"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s(`button
        onClick`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
          `),n("span",{class:"token function"},"setText"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`
          `),n("span",{class:"token function"},"setTodos"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"["),s(`
            `),n("span",{class:"token punctuation"},"{"),s(`
              `),n("span",{class:"token literal-property property"},"id"),n("span",{class:"token operator"},":"),s(" todos"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},","),s(`
              `),n("span",{class:"token literal-property property"},"text"),n("span",{class:"token operator"},":"),s(` text
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token operator"},"..."),s(`todos
          `),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},">"),s(`
        Add
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("button"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("ul"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"{"),s("todos"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"map"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"item"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"("),s(`
          `),n("span",{class:"token operator"},"<"),s("li key"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("item"),n("span",{class:"token punctuation"},"."),s("id"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("item"),n("span",{class:"token punctuation"},"."),s("text"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("li"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("ul"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1})]),_:1}),a[13]||(a[13]=l(`<div class="hint-container warning"><p class="hint-container-title">注意</p><p>尽管 <code>createInitialTodos()</code> 的结果仅用于初始渲染，但你仍然在每次渲染时调用此函数。如果它创建大数组或执行昂贵的计算，这可能会浪费资源。</p><p>所以对于大型数组的创建，一般传入初始化函数。</p></div><p><strong>返回值：</strong></p><p><code>useState</code> 返回一个数组，使用数组解构接收，其中包含两个值：</p><ol><li>当前状态。在第一次渲染时，它将与传递的初始状态 <code>initialState</code> 相匹配。</li><li><code>set</code> 函数，用于 <strong>状态更新</strong> 并 <strong>触发重新渲染</strong>。</li></ol><p><strong>注意：</strong></p><ul><li><code>useState</code> 是一个钩子，所以 <strong>只能</strong> 在组件的顶层或者你自己的钩子中调用它，<strong>不能</strong> 在循环或条件中调用它。</li><li>在严格模式下，React 会 <strong>调用两次初始化函数</strong>，其中一次调用的结果将被忽略，以帮助你找到意外的杂质。这是开发专用行为，不会影响生产环境。如果初始化函数是纯函数，就不会影响应用实际行为（因此初始化函数必须是纯函数）。</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p>若循环调用，则可能造成状态管理混乱、组件不一致、难以调试的问题。</p></div><h2 id="setsomething-nextstate" tabindex="-1"><a class="header-anchor" href="#setsomething-nextstate"><span>setSomething(nextState)</span></a></h2><p><code>set</code> 函数会 <strong>更新状态并触发重新渲染</strong>，可以直接传入 <code>next state</code>，或者传入一个纯函数。<code>set</code> 函数没有返回值。</p><p><code>setSomething()</code> 是一个异步函数，如下所示，<code>handleClick1</code> 点击一次后，年龄将变为 <code>43</code> 岁，而不是 <code>45</code> 岁。</p><p>这是因为调用 <code>set</code> 函数 <strong>不会同步</strong> 更新已运行代码中的年龄状态变量。</p><p>因此，每次调用 <code>setAge(age + 1)</code> 都会变成 <code>setAge(43)</code>。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">handleClick1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// setAge(42 + 1)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// setAge(42 + 1)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// setAge(42 + 1)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13)),n("div",g,[a[5]||(a[5]=n("p",{class:"hint-container-title"},"提示",-1)),n("p",null,[n("a",b,[a[4]||(a[4]=s("RFClarification: why is setState asynchronous?")),t(e)])])]),a[14]||(a[14]=l(`<p>如果传递一个函数作为 <code>nextState</code>，它将被视为一个更新函数。它必须是「纯函数」，应将待处理状态作为唯一参数，并返回下一个状态。</p><p>React 会将更新函数 <strong>放入队列</strong>，然后重新渲染组件。</p><p>在下一次渲染中，React 将通过将所有队列中的更新器 <strong>应用上一个状态来计算下一个状态(<code>previous state</code> to <code>next state</code>)</strong>。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">handleClick2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// setAge(42 =&gt; 43)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// setAge(43 =&gt; 44)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// setAge(44 =&gt; 45)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上述代码的处理过程如下：</p><ol><li><code>a =&gt; a + 1</code> 将接收 <code>42</code> 作为待处理状态，并返回 <code>43</code> 作为下一状态。</li><li><code>a =&gt; a + 1</code> 将接收 <code>43</code> 作为待处理状态，并返回 <code>44</code> 作为下一个状态。</li><li><code>a =&gt; a + 1</code> 将接收 <code>44</code> 作为待处理状态，并返回 <code>45</code> 作为下一个状态。</li></ol><p>没有其他队列更新，所以 React 会将 <code>45</code> 作为当前状态保存。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>按照惯例，通常以状态变量名称的首字母来命名待处理状态参数，如年龄的 <code>a</code>，也可以使用更加清晰的名称 <code>prevAge</code>。</p></div><div class="hint-container warning"><p class="hint-container-title">注意</p><ul><li><code>set</code> 函数只更新 <strong>下一次渲染</strong> 的状态变量。如果在调用 <code>set</code> 函数后读取状态变量，您仍然会得到调用前屏幕上的旧值。</li><li>如果提供的新值与当前状态相同（由 <code>Object.is</code> 比较确定），React 将 <strong>跳过重新渲染组件及其子代</strong>。</li><li>React 会批量更新状态。它会 <strong>在所有事件处理程序运行并调用其设置函数后更新屏幕</strong>。这可以防止在单个事件中多次重新渲染。在极少数情况下，需要强制 React 提前更新屏幕，例如访问 DOM，可以使用 <code>flushSync</code>。</li><li>与初始化函数类似，在严格模式下，React 会调用更新器函数 <strong>两次</strong>，以验证它们是否纯粹。</li></ul></div><h2 id="usage" tabindex="-1"><a class="header-anchor" href="#usage"><span>Usage</span></a></h2>`,10)),n("ul",null,[n("li",null,[n("a",f,[a[6]||(a[6]=s("Adding state to a component")),t(e)])]),n("li",null,[n("a",y,[a[7]||(a[7]=s("Updating state based on the previous state")),t(e)])]),n("li",null,[n("a",h,[a[8]||(a[8]=s("Updating objects and arrays in state")),t(e)])]),n("li",null,[n("a",S,[a[9]||(a[9]=s("Avoiding recreating the initial state")),t(e)])]),n("li",null,[n("a",x,[a[10]||(a[10]=s("Resetting state with a key")),t(e)])]),n("li",null,[n("a",w,[a[11]||(a[11]=s("Storing information from previous renders")),t(e)])])])])}const C=k(v,[["render",T],["__file","01-useState.html.vue"]]),E=JSON.parse('{"path":"/frontend/framework/react/01-useState.html","title":"useState","lang":"zh-CN","frontmatter":{"title":"useState","date":"2024-02-27T00:00:00.000Z","icon":"state","category":["react"],"tag":["react core","hooks","state hooks"],"description":"useState 声明一个可以直接更新的状态变量。 一般在组件 最顶层 调用 useState 给组件添加状态变量，一般使用数组解构来命名状态变量，如 [something, setSomething]。 useState(initialState) 参数： initialState：初始状态，可以是任何类型的值，初始渲染后，该参数将被忽略。 如果传递...","head":[["meta",{"property":"og:url","content":"https://dribble-njr.github.io/blog/blog/frontend/framework/react/01-useState.html"}],["meta",{"property":"og:title","content":"useState"}],["meta",{"property":"og:description","content":"useState 声明一个可以直接更新的状态变量。 一般在组件 最顶层 调用 useState 给组件添加状态变量，一般使用数组解构来命名状态变量，如 [something, setSomething]。 useState(initialState) 参数： initialState：初始状态，可以是任何类型的值，初始渲染后，该参数将被忽略。 如果传递..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-06T15:43:46.000Z"}],["meta",{"property":"article:author","content":"njr"}],["meta",{"property":"article:tag","content":"react core"}],["meta",{"property":"article:tag","content":"hooks"}],["meta",{"property":"article:tag","content":"state hooks"}],["meta",{"property":"article:published_time","content":"2024-02-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-06T15:43:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"useState\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-02-27T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-06T15:43:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"njr\\",\\"url\\":\\"https://github.com/dribble-njr/blog\\",\\"email\\":\\"wzw15292257101@163.com\\"}]}"]]},"headers":[{"level":2,"title":"1 useState(initialState)","slug":"usestate-initialstate","link":"#usestate-initialstate","children":[]},{"level":2,"title":"2 setSomething(nextState)","slug":"setsomething-nextstate","link":"#setsomething-nextstate","children":[]},{"level":2,"title":"3 Usage","slug":"usage","link":"#usage","children":[]}],"git":{"createdTime":1709027707000,"updatedTime":1730907826000,"contributors":[{"name":"dribble-njr","email":"wzw15292257101@163.com","commits":4}]},"readingTime":{"minutes":4.99,"words":1497},"filePathRelative":"frontend/framework/react/01-useState.md","localizedDate":"2024年2月27日","excerpt":"","autoDesc":true}');export{C as comp,E as data};
