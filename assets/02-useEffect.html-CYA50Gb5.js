import{_ as k,c as d,e as u,a as n,d as s,b as e,w as t,r,o as m}from"./app-DYGx5q5I.js";const v={},b={class:"hint-container tip"},f={href:"https://react.dev/learn/editor-setup#linting",target:"_blank",rel:"noopener noreferrer"},g={href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is",target:"_blank",rel:"noopener noreferrer"},h={href:"https://overreacted.io/a-complete-guide-to-useeffect/",target:"_blank",rel:"noopener noreferrer"};function w(y,a){const p=r("ExternalLinkIcon"),l=r("CodeDemo"),i=r("Tabs");return m(),d("div",null,[a[28]||(a[28]=u('<p><code>useEffect</code> 可以将组件与外部系统同步。</p><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>外部系统，包括网络、浏览器 API (<code>setTimeout</code>...）、第三方库或浏览器 DOM。</p></div><h2 id="useeffect-setup-dependencies" tabindex="-1"><a class="header-anchor" href="#useeffect-setup-dependencies"><span>useEffect(setup, dependencies?)</span></a></h2><h3 id="setup" tabindex="-1"><a class="header-anchor" href="#setup"><span><code>setup</code></span></a></h3><p>包含 Effect 逻辑的函数。该 <strong>设置函数</strong> 可以返回一个 <strong>清理函数</strong>。大致运行逻辑如下：</p><ol><li>当组件添加到 DOM 时，React 将运行「设置函数」。</li><li>在每次重新渲染依赖关系发生变化后： <ul><li>React 将首先使用 <strong>旧值</strong> 运行「清理函数」；</li><li>然后使用 <strong>新值</strong> 运行「设置函数」。</li></ul></li><li>从 DOM 中移除组件后，React 将最后一次运行「清理函数」。</li></ol><h3 id="dependencies" tabindex="-1"><a class="header-anchor" href="#dependencies"><span><code>dependencies</code></span></a></h3><p><code>setup</code> 代码中依赖的所有响应值的列表。</p><p>响应值包括 <code>props</code>、<code>state</code> 以及直接在组件主体中声明的所有变量和函数。</p>',9)),n("div",b,[a[3]||(a[3]=n("p",{class:"hint-container-title"},"提示",-1)),n("p",null,[a[1]||(a[1]=s("如果为 React 配置了 ")),n("a",f,[a[0]||(a[0]=s("linter")),e(p)]),a[2]||(a[2]=s("，它就会验证是否将每个反应值都正确指定为依赖项。"))])]),a[29]||(a[29]=n("p",null,[s("依赖项列表必须具有恒定的项数，并以 "),n("code",null,"[dep1、dep2、dep3]"),s(" 这样的内联方式书写。")],-1)),n("p",null,[a[5]||(a[5]=s("React 会使用 ")),n("a",g,[a[4]||(a[4]=n("code",null,"Object.is",-1)),e(p)]),a[6]||(a[6]=s(" 比较法将每个依赖项与其前一个值进行比较。"))]),a[30]||(a[30]=n("p",null,"如果省略此参数，每次重新渲染组件后，Effect 都会重新运行。",-1)),e(i,{id:"69",data:[{id:"传入一个依赖数组"},{id:"传入一个空数组"},{id:"完全不传递依赖关系数组"}]},{title0:t(({value:o,isActive:c})=>a[7]||(a[7]=[s("传入一个依赖数组")])),title1:t(({value:o,isActive:c})=>a[8]||(a[8]=[s("传入一个空数组")])),title2:t(({value:o,isActive:c})=>a[9]||(a[9]=[s("完全不传递依赖关系数组")])),tab0:t(({value:o,isActive:c})=>[a[11]||(a[11]=n("p",null,"如果指定了依赖关系，「Effect」就会在初始渲染后运行，并在更改依赖关系后重新渲染。",-1)),a[12]||(a[12]=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// ..."),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"["),s("a"),n("span",{class:"token punctuation"},","),s(" b"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// Runs again if a or b are different"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)),a[13]||(a[13]=n("p",null,[s("在下面的示例中，"),n("code",null,"serverUrl"),s(" 和 "),n("code",null,"roomId"),s(" 都是响应值，所以必须将它们指定为依赖关系。")],-1)),a[14]||(a[14]=n("p",null,"因此，在下拉菜单中选择不同的房间或编辑服务器 URL 输入会导致聊天重新连接。",-1)),a[15]||(a[15]=n("p",null,[s("但是，由于「Effect」中没有使用 "),n("code",null,"message"),s("（因此它不是依赖项），所以编辑 "),n("code",null,"message"),s(" 不会重新连接到聊天。")],-1)),e(l,{id:"code-demo-84",type:"react",title:"%E4%BC%A0%E5%85%A5%E4%B8%80%E4%B8%AA%E4%BE%9D%E8%B5%96%E6%95%B0%E7%BB%84",code:"eJyNVd1u0zAUfpVDLpZMVIkGXFVp0VS4QAIhbZoQIrvw0tOm4NqR7WygKJfc8QjwcnsSjmM7S7QOKlX13/F3zvm+z20bfdXRPCql0AZaaDReGmZwZmdvNxssDXSwgAtkpSlEITaNKM1OCigVUtxKCkExtJFoVLeorhSfgZJy/259Cm0hALIMzoGCOez2Ncc9CkpgEe5kw9dAuA3j/AdQCRYKjARTITg4C6DQNEo4MAhhiUf3W1pyTLncJmEPIL7//RNCfWJrcYsohue+OprERdQvgBmwB0MH9ixN0ziAnbpJN3Pjeqf/U0V8/+cXvBnCcA0bRXmOzR/y2YG+6DMiflUxc0G3kjYgdb4KJ+KXkRAazWVYXZOMQd4kroyp9TzLuCwZr6Q287MXL1/FfWaPs0et2ZasQCgf3HyKYaNt/GCVhPhYLEdKEYynwFa+OMY0E5UpJB2odifeDZNMk/ixOmMeZxNmXLZr30EAdfH5MsDmnN0gH5YAjk24ung/b2OIe2QfuhN1Q08krAFuGW9w0Q5JR8EAUpCOYkvnCfatjKVKMDVMbdGkPcbp6Gb2UFs2LS6vzpafkJdyj+ENta7Lru/2WZ5RxJOdfZaNAi/54d5CQz6oO9iDN8qjDp4sPHcHJERvc/xeS2VgjRvWcAOD68/rOjy2YPNK3jmH02RizA3jGsdOdjT0wfblkO4TH29RoGLcmf9oK6wqKTVRTTyX9CR7jh8Rp5Hb3zTPXJDjEHGusEe8jRISnKx7MhxcEfnCi2jpZ3nmIv55yyh2i/aSmxx1Z9/oXUlX+vHAjTxznY63bhpjCIKa5bvyG/U6+JwES55Z/ai/1o7wGuIVt3RaKmOYQ/yxRvqTsasuzxzUk9Z3GCcn9AYUGW0Q4GE//Gj6d/8gxRA98WHU/QXQWkX8"},{default:t(()=>a[10]||(a[10]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState"),n("span",{class:"token punctuation"},","),s(" useEffect "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"createConnection"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("serverUrl"),n("span",{class:"token punctuation"},","),s(" roomId")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// A real implementation would actually connect to the server"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"connect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token string"},`'✅ Connecting to "'`),s(),n("span",{class:"token operator"},"+"),s(" roomId "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},`'" room at '`),s(),n("span",{class:"token operator"},"+"),s(" serverUrl "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},"'...'"),s(`
      `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token function"},"disconnect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},`'❌ Disconnected from "'`),s(),n("span",{class:"token operator"},"+"),s(" roomId "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},`'" room at '`),s(),n("span",{class:"token operator"},"+"),s(" serverUrl"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"ChatRoom"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),s(" roomId "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("serverUrl"),n("span",{class:"token punctuation"},","),s(" setServerUrl"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'https://localhost:1234'"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("message"),n("span",{class:"token punctuation"},","),s(" setMessage"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" connection "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"createConnection"),n("span",{class:"token punctuation"},"("),s("serverUrl"),n("span",{class:"token punctuation"},","),s(" roomId"),n("span",{class:"token punctuation"},")"),s(`
    connection`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"connect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      connection`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"disconnect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"["),s("serverUrl"),n("span",{class:"token punctuation"},","),s(" roomId"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("label"),n("span",{class:"token operator"},">"),s(`
        Server `),n("span",{class:"token constant"},"URL"),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"' '"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s(`input
          value`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("serverUrl"),n("span",{class:"token punctuation"},"}"),s(`
          onChange`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setServerUrl"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("label"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("h1"),n("span",{class:"token operator"},">"),s("Welcome to the "),n("span",{class:"token punctuation"},"{"),s("roomId"),n("span",{class:"token punctuation"},"}"),s(" room"),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("h1"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("label"),n("span",{class:"token operator"},">"),s(`
        Your message`),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"' '"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s("input value"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("message"),n("span",{class:"token punctuation"},"}"),s(" onChange"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setMessage"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("label"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"App"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("show"),n("span",{class:"token punctuation"},","),s(" setShow"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("roomId"),n("span",{class:"token punctuation"},","),s(" setRoomId"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'general'"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("label"),n("span",{class:"token operator"},">"),s(`
        Choose the chat room`),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"' '"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s("select value"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("roomId"),n("span",{class:"token punctuation"},"}"),s(" onChange"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setRoomId"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token operator"},"<"),s("option value"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"general"'),n("span",{class:"token operator"},">"),s("general"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("option"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token operator"},"<"),s("option value"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"travel"'),n("span",{class:"token operator"},">"),s("travel"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("option"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token operator"},"<"),s("option value"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"music"'),n("span",{class:"token operator"},">"),s("music"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("option"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("select"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token operator"},"<"),s("button onClick"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setShow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("show"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'Close chat'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Open chat'"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("button"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("label"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"&&"),s(),n("span",{class:"token operator"},"<"),s("hr "),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"&&"),s(),n("span",{class:"token operator"},"<"),s("ChatRoom roomId"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("roomId"),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1})]),tab1:t(({value:o,isActive:c})=>[a[17]||(a[17]=n("p",null,"如果没有传入任何依赖值，那么它只会在初始渲染后运行。",-1)),a[18]||(a[18]=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// ..."),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// Does not run again (except once in development)"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)),a[19]||(a[19]=n("p",null,"即使依赖关系为空，设置和清理也会在开发过程中额外运行一次，以帮助查找错误。",-1)),a[20]||(a[20]=n("p",null,[s("在本例中，"),n("code",null,"serverUrl"),s(" 和 "),n("code",null,"roomId"),s(" 都是硬编码。由于它们是在组件外部声明的，因此不是反应值，也就不是依赖项。")],-1)),a[21]||(a[21]=n("p",null,"依赖列表是空的，因此 Effect 不会在重新呈现时重新运行。",-1)),e(l,{id:"code-demo-102",type:"react",title:"%E4%BC%A0%E5%85%A5%E4%B8%80%E4%B8%AA%E7%A9%BA%E6%95%B0%E7%BB%84",code:"eJyNU8Fu00AQ/ZWpD11HjWwVOEVJUBU4cEBIrRBCdQ9bZxwb1rvW7roFWT5y4xPg5/olzHq9joOEqBTF65k3b2beW3fRFxOtolxJY6GD1uCN5RaX7vS2KDC30MMGrpHnNpOZ9ECD+gH1Ry0oxUprG7NKU6FyLkpl7OryxctXLGC1UvW7vQPWralyimeyaGVuKyUh10jddkpK6kSBeGJejoUL6DIJkKZwBQQWUNWNwBoljekYHlUr9kDTtVyI70A9HRVYBbbEcVBHoNG2WnoyCLB4ZB9DRglMhDrEIQbAnn79gDCfPDjeLGJwEda6AJZFwwtwCy5x1IZySZLQwp5q4Q/90j/3lfnPFOzp9094M8FwD4WmPs/tH/q5B/3Rbyb8ruT2mqpCb+/VbY3G8APZb9C+9+c7si5ci5gxYnX46XrExLDZznQlmnFg12fzHItPPCFIMgnjM6N3vtMMNpdw2HIJt3fjgKHGM6y3QeB1ebn9hCJXNYZL0vkx+mGcs3VKiAkt+D2K6RXgs2o1jCqtOgZskHcEV7JpLTxw0eKmG0E9KEliywOFYhw2OGobY2K5PqBNhqJFD+mxdTrvvfYJWm7wEb81SlvYY8FbYWGy9app/nLUlOpxsPOGDideFlwYHHT7p1b3rbXEShuIKv9KC4T5HVl85rgX/UydzkXgNbCdUAYhp0vGYAXsQ4P0rbu3Sa516smnal97fk4OaZJhAh7j4c4esyeqRP0fjcuNBw=="},{default:t(()=>a[16]||(a[16]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState"),n("span",{class:"token punctuation"},","),s(" useEffect "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"const"),s(" serverUrl "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'https://localhost:1234'"),s(`
`),n("span",{class:"token keyword"},"const"),s(" roomId "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'music'"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"createConnection"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("serverUrl"),n("span",{class:"token punctuation"},","),s(" roomId")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// A real implementation would actually connect to the server"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"connect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token string"},`'✅ Connecting to "'`),s(),n("span",{class:"token operator"},"+"),s(" roomId "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},`'" room at '`),s(),n("span",{class:"token operator"},"+"),s(" serverUrl "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},"'...'"),s(`
      `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token function"},"disconnect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},`'❌ Disconnected from "'`),s(),n("span",{class:"token operator"},"+"),s(" roomId "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},`'" room at '`),s(),n("span",{class:"token operator"},"+"),s(" serverUrl"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"ChatRoom"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("message"),n("span",{class:"token punctuation"},","),s(" setMessage"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" connection "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"createConnection"),n("span",{class:"token punctuation"},"("),s("serverUrl"),n("span",{class:"token punctuation"},","),s(" roomId"),n("span",{class:"token punctuation"},")"),s(`
    connection`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"connect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(" connection"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"disconnect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("h1"),n("span",{class:"token operator"},">"),s("Welcome to the "),n("span",{class:"token punctuation"},"{"),s("roomId"),n("span",{class:"token punctuation"},"}"),s(" room"),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("h1"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("label"),n("span",{class:"token operator"},">"),s(`
        Your message`),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"' '"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s("input value"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("message"),n("span",{class:"token punctuation"},"}"),s(" onChange"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setMessage"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("label"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"App"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("show"),n("span",{class:"token punctuation"},","),s(" setShow"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("button onClick"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setShow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("show"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'Close chat'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Open chat'"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("button"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"&&"),s(),n("span",{class:"token operator"},"<"),s("hr "),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"&&"),s(),n("span",{class:"token operator"},"<"),s("ChatRoom "),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1})]),tab2:t(({value:o,isActive:c})=>[a[23]||(a[23]=n("p",null,"如果完全不传递依赖关系数组，那么在组件的每次渲染（和重新渲染）后都会运行 Effect。",-1)),a[24]||(a[24]=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// ..."),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// Always runs again"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)),a[25]||(a[25]=n("p",null,[s("在本例中，当更改 "),n("code",null,"serverUrl"),s(" 和 "),n("code",null,"roomId"),s(" 时，Effect 会重新运行，这是合理的。")],-1)),a[26]||(a[26]=n("p",null,"然而，当您更改信息时，它也会重新运行，这可能是不可取的。这就是通常要指定依赖关系数组的原因。",-1)),e(l,{id:"code-demo-117",type:"react",title:"%E5%AE%8C%E5%85%A8%E4%B8%8D%E4%BC%A0%E9%80%92%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB%E6%95%B0%E7%BB%84",code:"eJyNVEtu2zAQvcpEi0hGAwtpuzJkF4HbRYB+gARBUdRdMNLYckuTAkklDQQtu+sR2svlJB2KpCIhTmPAMH/Dx5n33qiJvutoFuVSaAMN1BovDTN4Ymfv1mvMDbQwhwtkuVmJlVjXIjdbKSBXSHFLKQTF0EaiUd2gulL8BJSUu/NiAs1KAKQpnAEFc9juKo47FPSARbiVNS+AcGvG+R1QChYKjARTIjg4C6DQ1Eo4MAhhiUf3W1pynHK5ScIeQHz/5xeE/MTG4q6iGF747GgSr6JuAcyAPegrsGfT6TQOYBM3aU/cWGz1M1nE939/w9s+DAtYK3rn0PfDe3agP/oNiF+WzFzQraQJSK3Pwon4dSCERnMZVt9IxiBvEpfGVHqWplzmjJdSm9npy1ev4+5lj7NDrdmGrEAoH9x8jGGjbXxvlYT4mC8GShGMp8BmPj/ENCOVKWTaU+1OvBtGL43ih+oMeZxYJ36UUGCFokCR3wFTitG/ATKgKyWgu4vZIuBnnF0j75cAjla4ung/a2KIuyd86FZUNfVKWAPcMF7jvOlrHQQDSEGCig2dJ9jVNNQswalhaoNm2mFMBjfTh9zScXJZebr4jDyXOwzN1Dhy247koyyliCcr+yJrBV77/bWFgnxQu7cG75hHFTyZeOYOSLPO7/izksqQWmtWcwO9/c+qKnRd8Hspb53VaTJy6JpxjUNLOxq6YNtC58XY0BsUqBh3XXCwFZallJqoJp5z6s2O40fEaeT24+aZC3LsI84l9oi3wYMEJ6uODAe3inziq2jhZ1nqIv57yyh2g/aSmxx0Z1frbU5XunHPjSx1lQ63rmtjCIKK5dv8B9Xa+5wES46sflRfY0d4A/GSWzotlTHMIP5E7epWbZY6qCet7zCOj6kHFBmtF+BhP3w9/efmQYo+euTDqP0HkRNInw=="},{default:t(()=>a[22]||(a[22]=[n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"{"),s(" useState"),n("span",{class:"token punctuation"},","),s(" useEffect "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"="),s(` React

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"createConnection"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("serverUrl"),n("span",{class:"token punctuation"},","),s(" roomId")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// A real implementation would actually connect to the server"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"connect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token string"},`'✅ Connecting to "'`),s(),n("span",{class:"token operator"},"+"),s(" roomId "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},`'" room at '`),s(),n("span",{class:"token operator"},"+"),s(" serverUrl "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},"'...'"),s(`
      `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token function"},"disconnect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},`'❌ Disconnected from "'`),s(),n("span",{class:"token operator"},"+"),s(" roomId "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},`'" room at '`),s(),n("span",{class:"token operator"},"+"),s(" serverUrl"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"ChatRoom"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),s(" roomId "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("serverUrl"),n("span",{class:"token punctuation"},","),s(" setServerUrl"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'https://localhost:1234'"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("message"),n("span",{class:"token punctuation"},","),s(" setMessage"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"''"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" connection "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"createConnection"),n("span",{class:"token punctuation"},"("),s("serverUrl"),n("span",{class:"token punctuation"},","),s(" roomId"),n("span",{class:"token punctuation"},")"),s(`
    connection`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"connect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      connection`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"disconnect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token comment"},"// No dependency array at all"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("label"),n("span",{class:"token operator"},">"),s(`
        Server `),n("span",{class:"token constant"},"URL"),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"' '"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s(`input
          value`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("serverUrl"),n("span",{class:"token punctuation"},"}"),s(`
          onChange`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setServerUrl"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("label"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("h1"),n("span",{class:"token operator"},">"),s("Welcome to the "),n("span",{class:"token punctuation"},"{"),s("roomId"),n("span",{class:"token punctuation"},"}"),s(" room"),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("h1"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("label"),n("span",{class:"token operator"},">"),s(`
        Your message`),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"' '"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s("input value"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("message"),n("span",{class:"token punctuation"},"}"),s(" onChange"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setMessage"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("label"),n("span",{class:"token operator"},">"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"default"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"App"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("show"),n("span",{class:"token punctuation"},","),s(" setShow"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("roomId"),n("span",{class:"token punctuation"},","),s(" setRoomId"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'general'"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),s("label"),n("span",{class:"token operator"},">"),s(`
        Choose the chat room`),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},"' '"),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token operator"},"<"),s("select value"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("roomId"),n("span",{class:"token punctuation"},"}"),s(" onChange"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setRoomId"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("target"),n("span",{class:"token punctuation"},"."),s("value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token operator"},"<"),s("option value"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"general"'),n("span",{class:"token operator"},">"),s("general"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("option"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token operator"},"<"),s("option value"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"travel"'),n("span",{class:"token operator"},">"),s("travel"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("option"),n("span",{class:"token operator"},">"),s(`
          `),n("span",{class:"token operator"},"<"),s("option value"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"music"'),n("span",{class:"token operator"},">"),s("music"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("option"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("select"),n("span",{class:"token operator"},">"),s(`
        `),n("span",{class:"token operator"},"<"),s("button onClick"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"setShow"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("show"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"?"),s(),n("span",{class:"token string"},"'Close chat'"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'Open chat'"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("button"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),s("label"),n("span",{class:"token operator"},">"),s(`
      `),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"&&"),s(),n("span",{class:"token operator"},"<"),s("hr "),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"}"),s(`
      `),n("span",{class:"token punctuation"},"{"),s("show "),n("span",{class:"token operator"},"&&"),s(),n("span",{class:"token operator"},"<"),s("ChatRoom roomId"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s("roomId"),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1)])),_:1})]),_:1}),a[31]||(a[31]=n("h2",{id:"useeffect-完整指南",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#useeffect-完整指南"},[n("span",null,"useEffect 完整指南")])],-1)),n("p",null,[n("a",h,[a[27]||(a[27]=s("useEffect 完整指南")),e(p)])]),a[32]||(a[32]=u('<h3 id="每一次渲染都有自己的-props-和-state" tabindex="-1"><a class="header-anchor" href="#每一次渲染都有自己的-props-和-state"><span>每一次渲染都有自己的 props 和 state</span></a></h3><p>和 Vue 不同，Vue 的基本原理是数据绑定、观察者模式、proxy。</p><p>React 在状态变更时会重新渲染组件，状态并没有任何的数据绑定。</p><p>每一次组件调用引起的渲染，props 和 state 都独立于其他渲染。</p><h3 id="每一次渲染都有自己的事件处理程序" tabindex="-1"><a class="header-anchor" href="#每一次渲染都有自己的事件处理程序"><span>每一次渲染都有自己的事件处理程序</span></a></h3><p>事件处理函数会记住当前渲染的 <code>props</code> 和 <code>state</code>，从这个角度来说可以印证第一点。</p><h3 id="每一次渲染都有自己的-effects" tabindex="-1"><a class="header-anchor" href="#每一次渲染都有自己的-effects"><span>每一次渲染都有自己的 Effects</span></a></h3><p>每次渲染都是一个 <em>不同的函数</em> ，每一个 effect 版本「看到」的 <code>props</code> 和 <code>state</code> 值都来自于它属于的那次特定渲染。</p><p>从官方文档中的描述中也可以确认这一点：<strong>在每次重新渲染依赖关系发生变化后，React 将首先使用旧值运行清理函数，然后使用新值运行设置函数。</strong></p><p>每一次渲染的任何东西都是独立的。**在组件内什么时候去读取 props 或者 state 是无关紧要的。**因为在单次渲染的范围内，props 和 state 始终保持不变。</p>',10))])}const C=k(v,[["render",w],["__file","02-useEffect.html.vue"]]),j=JSON.parse('{"path":"/frontend/framework/react/02-useEffect.html","title":"useEffect","lang":"zh-CN","frontmatter":{"title":"useEffect","date":"2024-02-27T00:00:00.000Z","icon":"effect","category":["react"],"tag":["react core","hooks","effect hooks"],"description":"useEffect 可以将组件与外部系统同步。 相关信息 外部系统，包括网络、浏览器 API (setTimeout...）、第三方库或浏览器 DOM。 useEffect(setup, dependencies?) setup 包含 Effect 逻辑的函数。该 设置函数 可以返回一个 清理函数。大致运行逻辑如下： 当组件添加到 DOM 时，Reac...","head":[["meta",{"property":"og:url","content":"https://dribble-njr.github.io/blog/blog/frontend/framework/react/02-useEffect.html"}],["meta",{"property":"og:title","content":"useEffect"}],["meta",{"property":"og:description","content":"useEffect 可以将组件与外部系统同步。 相关信息 外部系统，包括网络、浏览器 API (setTimeout...）、第三方库或浏览器 DOM。 useEffect(setup, dependencies?) setup 包含 Effect 逻辑的函数。该 设置函数 可以返回一个 清理函数。大致运行逻辑如下： 当组件添加到 DOM 时，Reac..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-06T15:43:46.000Z"}],["meta",{"property":"article:author","content":"njr"}],["meta",{"property":"article:tag","content":"react core"}],["meta",{"property":"article:tag","content":"hooks"}],["meta",{"property":"article:tag","content":"effect hooks"}],["meta",{"property":"article:published_time","content":"2024-02-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-06T15:43:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"useEffect\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-02-27T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-06T15:43:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"njr\\",\\"url\\":\\"https://github.com/dribble-njr/blog\\",\\"email\\":\\"wzw15292257101@163.com\\"}]}"]]},"headers":[{"level":2,"title":"1 useEffect(setup, dependencies?)","slug":"useeffect-setup-dependencies","link":"#useeffect-setup-dependencies","children":[{"level":3,"title":"1.1 setup","slug":"setup","link":"#setup","children":[]},{"level":3,"title":"1.2 dependencies","slug":"dependencies","link":"#dependencies","children":[]}]},{"level":2,"title":"2 useEffect 完整指南","slug":"useeffect-完整指南","link":"#useeffect-完整指南","children":[{"level":3,"title":"2.1 每一次渲染都有自己的 props 和 state","slug":"每一次渲染都有自己的-props-和-state","link":"#每一次渲染都有自己的-props-和-state","children":[]},{"level":3,"title":"2.2 每一次渲染都有自己的事件处理程序","slug":"每一次渲染都有自己的事件处理程序","link":"#每一次渲染都有自己的事件处理程序","children":[]},{"level":3,"title":"2.3 每一次渲染都有自己的 Effects","slug":"每一次渲染都有自己的-effects","link":"#每一次渲染都有自己的-effects","children":[]}]}],"git":{"createdTime":1709030597000,"updatedTime":1730907826000,"contributors":[{"name":"dribble-njr","email":"wzw15292257101@163.com","commits":3}]},"readingTime":{"minutes":5.03,"words":1510},"filePathRelative":"frontend/framework/react/02-useEffect.md","localizedDate":"2024年2月27日","excerpt":"","autoDesc":true}');export{C as comp,j as data};
